<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ø¯Ø³ØªÛŒØ§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --bg: #0b0e1a;
            --card: #161a2e;
            --accent: #e94560;
            --green: #00c896;
            --red: #ff6b6b;
            --yellow: #ffd166;
            --blue: #4cc9f0;
            --purple: #7209b7;
            --text: #f2f2f2;
            --muted: #9ca3c7;
        }
        
        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1800px;
            margin: auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            color: var(--text);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: var(--muted);
            font-size: 1rem;
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ (Ú©Ø§Ù…Ù„) */
        .main-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        @media (max-width: 768px) {
            .main-controls {
                flex-direction: column;
            }
        }
        
        .search-container {
            flex: 2;
            position: relative;
            min-width: 300px;
        }
        
        input, button, select {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            border: none;
            background: #1c2040;
            color: white;
            margin-bottom: 10px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        input:focus, button:focus, select:focus {
            outline: 2px solid var(--accent);
        }
        
        button {
            background: var(--accent);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
            flex: 1;
            min-width: 200px;
        }
        
        button:hover {
            background: #ff2e4d;
            transform: translateY(-2px);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .card {
            background: var(--card);
            border-radius: 18px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .badge {
            padding: 8px 18px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            font-size: 0.9rem;
        }
        
        .buy { background: rgba(0, 200, 150, .2); color: var(--green); }
        .sell { background: rgba(255, 107, 107, .2); color: var(--red); }
        .hold { background: rgba(255, 209, 102, .2); color: var(--yellow); }
        .wait { background: rgba(255, 255, 255, .1); color: var(--muted); }
        
        .analysis-box {
            background: rgba(255, 255, 255, .05);
            border-radius: 14px;
            padding: 20px;
            margin-top: 20px;
        }
        
        .analysis-box h3 {
            margin-top: 0;
            color: var(--yellow);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            padding-bottom: 10px;
        }
        
        .time-box {
            background: rgba(255, 255, 255, .04);
            border-radius: 12px;
            padding: 12px;
            margin-top: 15px;
            font-size: .9rem;
            color: var(--muted);
            display: inline-block;
        }
        
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            overflow: hidden;
        }
        
        th, td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid rgba(255, 255, 255, .1);
        }
        
        th {
            background: rgba(0, 0, 0, 0.3);
            color: var(--muted);
            font-weight: 600;
        }
        
        tr:hover {
            background: rgba(255, 255, 255, .05);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: var(--yellow);
        }
        
        .coin-row {
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-btn {
            padding: 8px 16px;
            border-radius: 8px;
            border: none;
            background: var(--accent);
            color: white;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        
        .suggestions-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--card);
            border-radius: 8px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
            border: 1px solid rgba(255, 255, 255, .1);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        }
        
        .suggestion-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255, 255, 255, .05);
            transition: all 0.2s;
        }
        
        .suggestion-item:hover {
            background: rgba(255, 255, 255, .1);
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .analysis-card {
            background: rgba(255, 255, 255, .03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .analysis-card h4 {
            margin-top: 0;
            color: var(--blue);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding-bottom: 10px;
        }
        
        .indicator-value {
            display: inline-block;
            background: rgba(255, 255, 255, .1);
            padding: 4px 10px;
            border-radius: 6px;
            margin-left: 5px;
            font-family: 'Courier New', monospace;
            color: var(--yellow);
            font-size: 0.9rem;
        }
        
        .alert-warning {
            background: rgba(255, 209, 102, .1);
            color: var(--yellow);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 4px solid var(--yellow);
        }
        
        .alert-success {
            background: rgba(0, 200, 150, .1);
            color: var(--green);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 4px solid var(--green);
        }
        
        .alert-danger {
            background: rgba(255, 107, 107, .1);
            color: var(--red);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border-right: 4px solid var(--red);
        }
        
        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, .1);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .tab-container {
            margin: 25px 0;
        }
        
        .tab-header {
            display: flex;
            border-bottom: 1px solid rgba(255, 255, 255, .1);
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .tab-btn {
            padding: 14px 24px;
            background: none;
            border: none;
            color: var(--muted);
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 16px;
            font-weight: 500;
        }
        
        .tab-btn:hover {
            color: var(--yellow);
            background: rgba(255, 255, 255, 0.03);
        }
        
        .tab-btn.active {
            color: var(--yellow);
            border-bottom-color: var(--yellow);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .tab-content {
            display: none;
            padding: 25px 0;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .value-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, .05);
        }
        
        .value-label {
            color: var(--muted);
            font-size: 0.95rem;
        }
        
        .value-number {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 1.1rem;
        }
        
        .good { color: var(--green); }
        .bad { color: var(--red); }
        .neutral { color: var(--yellow); }
        
        .volatility-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .volatility-low { background: var(--green); }
        .volatility-medium { background: var(--yellow); }
        .volatility-high { background: var(--red); }
        
        .technical-analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0 15px 0;
        }
        
        .technical-analysis-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .data-source {
            font-size: 12px;
            color: var(--muted);
            margin-top: 5px;
            text-align: center;
        }
        
        .real-time-badge {
            background: rgba(76, 201, 240, .2);
            color: var(--blue);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 11px;
            margin-left: 8px;
            font-weight: bold;
        }
        
        .loading-spinner {
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .market-overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .market-metric {
            background: rgba(255, 255, 255, .03);
            border-radius: 14px;
            padding: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.3s;
        }
        
        .market-metric:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
        }
        
        .market-metric h4 {
            margin: 0 0 10px 0;
            color: var(--muted);
            font-size: 14px;
        }
        
        .market-metric-value {
            font-size: 26px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .market-metric-change {
            font-size: 14px;
            margin-top: 5px;
            font-weight: 500;
        }
        
        .coin-detail-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 25px;
        }
        
        @media (max-width: 1200px) {
            .coin-detail-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .analysis-section {
            margin: 25px 0;
        }
        
        .indicator-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .indicator-item {
            background: rgba(255, 255, 255, .02);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .indicator-label {
            font-size: 13px;
            color: var(--muted);
            margin-bottom: 8px;
        }
        
        .indicator-value-display {
            font-size: 18px;
            font-weight: bold;
        }
        
        .pattern-indicators {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .pattern-badge {
            background: rgba(76, 201, 240, .1);
            color: var(--blue);
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .chart-container {
            height: 380px;
            margin-top: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            padding: 15px;
        }
        
        .status-bar {
            padding: 12px 20px;
            border-radius: 10px;
            margin: 15px 0;
            display: none;
            align-items: center;
            font-weight: 500;
        }
        
        .status-info {
            background: rgba(76, 201, 240, .1);
            color: var(--blue);
            border-right: 4px solid var(--blue);
        }
        
        .status-success {
            background: rgba(0, 200, 150, .1);
            color: var(--green);
            border-right: 4px solid var(--green);
        }
        
        .status-error {
            background: rgba(255, 107, 107, .1);
            color: var(--red);
            border-right: 4px solid var(--red);
        }
        
        .status-warning {
            background: rgba(255, 209, 102, .1);
            color: var(--yellow);
            border-right: 4px solid var(--yellow);
        }
        
        .market-sentiment {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.03);
        }
        
        .sentiment-indicator {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            display: inline-block;
        }
        
        .sentiment-bullish { background: var(--green); }
        .sentiment-bearish { background: var(--red); }
        .sentiment-neutral { background: var(--yellow); }
        
        .coin-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 20px;
            font-weight: bold;
            margin: 8px 0;
        }
        
        .stat-label {
            font-size: 12px;
            color: var(--muted);
        }
        
        .price-change-indicator {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .change-up {
            background: rgba(0, 200, 150, .2);
            color: var(--green);
        }
        
        .change-down {
            background: rgba(255, 107, 107, .2);
            color: var(--red);
        }
        
        .detail-view-btn {
            background: rgba(114, 9, 183, 0.2);
            color: var(--purple);
            padding: 8px 16px;
            border-radius: 8px;
            text-decoration: none;
            display: inline-block;
            font-size: 13px;
            font-weight: bold;
            transition: all 0.3s;
            border: 1px solid rgba(114, 9, 183, 0.3);
        }
        
        .detail-view-btn:hover {
            background: rgba(114, 9, 183, 0.4);
            transform: translateY(-2px);
        }
        
        .performance-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .metric-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 24px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .metric-label {
            font-size: 13px;
            color: var(--muted);
        }
        
        .live-update-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 5px 12px;
            background: rgba(76, 201, 240, 0.1);
            color: var(--blue);
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .blink {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .control-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            padding: 12px 24px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .control-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent);
        }
        
        .control-btn.active {
            background: var(--accent);
            border-color: var(--accent);
        }
        
        .mode-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 10px 20px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: var(--text);
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .mode-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent);
        }
        
        .mode-btn.active {
            background: var(--accent);
            border-color: var(--accent);
        }
        
        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ */
        
        /* Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ */
        .fibonacci-levels {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .fib-level {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.01);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }
        
        .fib-level.active {
            background: rgba(255, 209, 102, 0.1);
            border-color: var(--yellow);
        }
        
        .fib-label {
            font-size: 12px;
            color: var(--muted);
            min-width: 50px;
        }
        
        .fib-value {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            flex: 1;
            text-align: center;
        }
        
        .fib-distance {
            font-size: 11px;
            padding: 2px 8px;
            border-radius: 10px;
            min-width: 60px;
            text-align: center;
        }
        
        .fib-distance.up {
            background: rgba(0, 200, 150, 0.1);
            color: var(--green);
        }
        
        .fib-distance.down {
            background: rgba(255, 107, 107, 0.1);
            color: var(--red);
        }
        
        /* Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª */
        .sr-levels-container {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .sr-level {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            margin: 8px 0;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.01);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
        }
        
        .sr-level.current {
            background: rgba(76, 201, 240, 0.1);
            border-color: var(--blue);
        }
        
        .sr-level.resistance {
            border-left: 3px solid var(--red);
        }
        
        .sr-level.support {
            border-left: 3px solid var(--green);
        }
        
        .sr-label {
            font-size: 13px;
            color: var(--muted);
            min-width: 100px;
        }
        
        .sr-price {
            font-family: 'Courier New', monospace;
            font-weight: bold;
            flex: 1;
        }
        
        .sr-distance {
            font-size: 12px;
            padding: 2px 10px;
            border-radius: 12px;
            margin: 0 10px;
            background: rgba(255, 255, 255, 0.05);
        }
        
        .sr-strength {
            width: 60px;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
        }
        
        .sr-strength-bar {
            height: 100%;
            background: var(--green);
            transition: width 0.3s;
        }
        
        /* Ø§Ø®Ø¨Ø§Ø± Ùˆ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ */
        .news-container,
        .events-container {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .news-item,
        .event-item {
            padding: 12px 15px;
            margin: 10px 0;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }
        
        .news-item:hover,
        .event-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transform: translateX(-5px);
        }
        
        .news-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .news-source {
            color: var(--blue);
            font-weight: bold;
        }
        
        .news-time {
            color: var(--muted);
        }
        
        .news-sentiment {
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: bold;
        }
        
        .news-sentiment-positive {
            background: rgba(0, 200, 150, 0.1);
            color: var(--green);
        }
        
        .news-sentiment-negative {
            background: rgba(255, 107, 107, 0.1);
            color: var(--red);
        }
        
        .news-sentiment-neutral {
            background: rgba(255, 255, 255, 0.1);
            color: var(--muted);
        }
        
        .news-title {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .news-link {
            font-size: 12px;
            color: var(--blue);
            text-decoration: none;
        }
        
        .news-link:hover {
            text-decoration: underline;
        }
        
        /* Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ */
        .event-date {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 12px;
        }
        
        .event-day {
            color: var(--yellow);
            font-weight: bold;
        }
        
        .event-days-left {
            color: var(--muted);
            padding: 2px 8px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
        }
        
        .event-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .event-title {
            font-size: 14px;
            font-weight: 500;
        }
        
        .event-type {
            font-size: 11px;
            padding: 2px 8px;
            background: rgba(76, 201, 240, 0.1);
            color: var(--blue);
            border-radius: 10px;
        }
        
        .event-importance-high {
            border-right: 3px solid var(--red);
        }
        
        .event-importance-medium {
            border-right: 3px solid var(--yellow);
        }
        
        .event-importance-low {
            border-right: 3px solid var(--green);
        }
        
        /* Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ */
        .onchain-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .onchain-metric {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .metric-label {
            font-size: 12px;
            color: var(--muted);
            margin-bottom: 8px;
        }
        
        .metric-value {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .metric-change {
            font-size: 12px;
            padding: 3px 10px;
            border-radius: 12px;
            display: inline-block;
        }
        
        .metric-change.positive {
            background: rgba(0, 200, 150, 0.1);
            color: var(--green);
        }
        
        .metric-change.negative {
            background: rgba(255, 107, 107, 0.1);
            color: var(--red);
        }
        
        .metric-change.neutral {
            background: rgba(255, 255, 255, 0.1);
            color: var(--muted);
        }
        
        /* Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ */
        .patterns-container {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 15px 0;
        }
        
        .pattern-badge-advanced {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .pattern-buy {
            background: rgba(0, 200, 150, 0.1);
            color: var(--green);
            border: 1px solid rgba(0, 200, 150, 0.3);
        }
        
        .pattern-sell {
            background: rgba(255, 107, 107, 0.1);
            color: var(--red);
            border: 1px solid rgba(255, 107, 107, 0.3);
        }
        
        .pattern-neutral {
            background: rgba(255, 209, 102, 0.1);
            color: var(--yellow);
            border: 1px solid rgba(255, 209, 102, 0.3);
        }
        
        /* ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… */
        .volume-analysis {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .volume-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        
        .volume-metric {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.01);
            border-radius: 8px;
        }
        
        .volume-metric-value {
            font-size: 20px;
            font-weight: bold;
            margin: 8px 0;
        }
        
        .volume-metric-label {
            font-size: 12px;
            color: var(--muted);
        }
        
        /* ØªØ¨â€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ */
        .advanced-tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .advanced-tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .advanced-analysis-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .advanced-feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .feature-card {
            background: rgba(255, 255, 255, 0.02);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s;
        }
        
        .feature-card:hover {
            border-color: var(--accent);
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 24px;
            color: var(--blue);
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 18px;
            margin-bottom: 10px;
            color: var(--text);
        }
        
        .feature-description {
            font-size: 14px;
            color: var(--muted);
            line-height: 1.6;
        }
        
        /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ */
        @media (max-width: 768px) {
            .advanced-feature-grid {
                grid-template-columns: 1fr;
            }
            
            .coin-detail-grid {
                grid-template-columns: 1fr;
            }
            
            .onchain-metrics {
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-chart-network"></i> Ø¯Ø³ØªÛŒØ§Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h1>
            <p class="subtitle">ğŸ“ˆ ØªØ­Ù„ÛŒÙ„ 10 Ùˆ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± | ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ | âš¡ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡ | ğŸ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´Ù…Ù†Ø¯ | ğŸ“Š Û· ÙˆÛŒÚ˜Ú¯ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ Ø¬Ø¯ÛŒØ¯</p>
            <div class="time-box" id="current-time"><i class="fas fa-clock"></i> Û±Ûµ:Û´Û°:Û²Û³ - Û±Û´Û°Û´/Û±Û°/Û²</div>
        </header>

        <div class="main-controls">
            <div class="search-container">
                <input id="search" type="text" placeholder="ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ø±Ø² (BTC, ETH, BNB, XRP, ADA, SOL, ...)" autocomplete="off" value="Bitcoin (BTC)">
                <div id="suggestions-dropdown" class="suggestions-dropdown"></div>
            </div>
            <button id="analyze-top10-btn">
                <i class="fas fa-bolt"></i> ØªØ­Ù„ÛŒÙ„ ÙÙˆØ±ÛŒ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±
            </button>
            <button id="analyze-top40-btn">
                <i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±
            </button>
            <button id="refresh-btn">
                <i class="fas fa-sync-alt"></i> Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
            </button>
        </div>

        <div class="mode-selector">
            <button class="mode-btn active" data-mode="top10">
                <i class="fas fa-list-ol"></i> Ø­Ø§Ù„Øª 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±
            </button>
            <button class="mode-btn" data-mode="top40">
                <i class="fas fa-list-alt"></i> Ø­Ø§Ù„Øª 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±
            </button>
            <button class="mode-btn" data-mode="search">
                <i class="fas fa-search"></i> Ø­Ø§Ù„Øª Ø¬Ø³ØªØ¬ÙˆÛŒ ØªÚ©ÛŒ
            </button>
        </div>

        <div id="status-bar" class="status-bar status-info" style="display: none;">
            <i class="fas fa-info-circle"></i>
            <span id="status-message">Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²...</span>
        </div>

        <div id="output">
            <div class="card">
                <h2><i class="fas fa-rocket"></i> ØªØ­Ù„ÛŒÙ„Ú¯Ø± Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>
                <p>Ø¨Ø§ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² Ø§ÛŒÙ† Ø§Ø¨Ø²Ø§Ø± Ù¾ÛŒØ´Ø±ÙØªÙ‡ØŒ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ 10 ÛŒØ§ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø± Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯ØŒ Ù‡Ø± Ø§Ø±Ø²ÛŒ Ø±Ø§ Ø¬Ø³ØªØ¬Ùˆ Ù†Ù…Ø§ÛŒÛŒØ¯ Ùˆ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§ÛŒ Ø¯Ù‚ÛŒÙ‚ Ù…Ø¨ØªÙ†ÛŒ Ø¨Ø± Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ú©Ù†ÛŒØ¯.</p>
                
                <div class="market-overview-grid">
                    <div class="market-metric">
                        <h4><i class="fas fa-coins"></i> ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±</h4>
                        <div class="market-metric-value">ØªØ­Ù„ÛŒÙ„ Ø³Ø±ÛŒØ¹</div>
                        <div class="market-metric-change">Ø¨Ù‡ØªØ±ÛŒÙ† Ø§Ø±Ø²Ù‡Ø§ Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ</div>
                    </div>
                    <div class="market-metric">
                        <h4><i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±</h4>
                        <div class="market-metric-value">ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹</div>
                        <div class="market-metric-change">Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù¾Ù†Ù‡Ø§Ù†</div>
                    </div>
                    <div class="market-metric">
                        <h4><i class="fas fa-search"></i> Ø¬Ø³ØªØ¬ÙˆÛŒ ØªÚ©ÛŒ</h4>
                        <div class="market-metric-value">Ù‡Ø± Ø§Ø±Ø²ÛŒ Ø±Ø§ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯</div>
                        <div class="market-metric-change">ØªØ­Ù„ÛŒÙ„ Ø¹Ù…ÛŒÙ‚ Ùˆ Ø¯Ù‚ÛŒÙ‚</div>
                    </div>
                    <div class="market-metric">
                        <h4><i class="fas fa-bolt"></i> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡</h4>
                        <div class="market-metric-value">Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</div>
                        <div class="market-metric-change">Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®ÙˆØ¯Ú©Ø§Ø±</div>
                    </div>
                </div>
                
                <div class="advanced-feature-grid">
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-ruler-combined"></i></div>
                        <div class="feature-title">Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ</div>
                        <div class="feature-description">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·ÙˆØ­ Ø¨Ø§Ø²Ú¯Ø´Øª ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ø­Ù…Ø§ÛŒØª Ùˆ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¯ÛŒÙ†Ø§Ù…ÛŒÚ©</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-shapes"></i></div>
                        <div class="feature-title">Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ</div>
                        <div class="feature-description">Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ú©Ù„Ø§Ø³ÛŒÚ© Ù…Ø§Ù†Ù†Ø¯ Ø³Ø± Ùˆ Ø´Ø§Ù†Ù‡ØŒ Ø¯Ùˆ Ù‚Ù„Ù‡ØŒ Ù…Ø«Ù„Ø« Ùˆ Ù¾Ø±Ú†Ù…</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-chart-bar"></i></div>
                        <div class="feature-title">ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
                        <div class="feature-description">ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ùˆ Ù‡Ù…Ú¯Ø±Ø§ÛŒÛŒ/ÙˆØ§Ú¯Ø±Ø§ÛŒÛŒ Ø¨Ø§ Ù‚ÛŒÙ…Øª Ø¨Ø±Ø§ÛŒ ØªØ£ÛŒÛŒØ¯ Ø±ÙˆÙ†Ø¯</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-shield-alt"></i></div>
                        <div class="feature-title">Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª</div>
                        <div class="feature-description">Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø®ÙˆØ¯Ú©Ø§Ø± Ø³Ø·ÙˆØ­ Ú©Ù„ÛŒØ¯ÛŒ Ø­Ù…Ø§ÛŒØª Ùˆ Ù…Ù‚Ø§ÙˆÙ…Øª Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-newspaper"></i></div>
                        <div class="feature-title">Ø§Ø®Ø¨Ø§Ø± Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</div>
                        <div class="feature-description">Ø¯Ø±ÛŒØ§ÙØª Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø± Ùˆ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø§Ø² Ù…Ù†Ø§Ø¨Ø¹ Ù…Ø¹ØªØ¨Ø±</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-calendar-alt"></i></div>
                        <div class="feature-title">ØªÙ‚ÙˆÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</div>
                        <div class="feature-description">Ø¨Ø±Ø±Ø³ÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù… Ø¢ØªÛŒ Ù…Ø§Ù†Ù†Ø¯ Ù‡Ø§Ø±Ø¯ÙÙˆØ±Ú©ØŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒâ€ŒÙ‡Ø§ Ùˆ Ø¬Ù„Ø³Ø§Øª</div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon"><i class="fas fa-link"></i></div>
                        <div class="feature-title">Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ</div>
                        <div class="feature-description">ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ on-chain Ù…Ø§Ù†Ù†Ø¯ Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ Ùˆ Ø¬Ø±ÛŒØ§Ù† ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§</div>
                    </div>
                </div>
                
                <div class="market-sentiment" id="initial-sentiment">
                    <div class="sentiment-indicator sentiment-neutral"></div>
                    <span>ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²Ø§Ø±: Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù„ÛŒÙ„ Ø§ÙˆÙ„ÛŒÙ‡ - Û· ÙˆÛŒÚ˜Ú¯ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ Ø¬Ø¯ÛŒØ¯ ÙØ¹Ø§Ù„ Ø´Ø¯</span>
                </div>
                
                <div class="control-group">
                    <button id="start-analysis-10-btn" class="control-btn active">
                        <i class="fas fa-play-circle"></i> Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±
                    </button>
                    <button id="start-analysis-40-btn" class="control-btn">
                        <i class="fas fa-play-circle"></i> Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±
                    </button>
                    <button id="show-search-help" class="control-btn">
                        <i class="fas fa-question-circle"></i> Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ
                    </button>
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² -->
        <div class="tab-container" id="coins-section-10" style="display: none;">
            <div class="tab-header">
                <button class="tab-btn active" data-tab="all-coins-10">
                    <i class="fas fa-list"></i> Ù„ÛŒØ³Øª 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±
                </button>
                <button class="tab-btn" data-tab="market-analysis-10">
                    <i class="fas fa-chart-pie"></i> ØªØ­Ù„ÛŒÙ„ Ú©Ù„ÛŒ Ø¨Ø§Ø²Ø§Ø±
                </button>
                <button class="tab-btn" data-tab="swing-opportunities-10">
                    <i class="fas fa-bolt"></i> ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                </button>
                <button class="tab-btn" data-tab="risk-metrics-10">
                    <i class="fas fa-shield-alt"></i> Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú©
                </button>
            </div>

            <div class="tab-content active" id="all-coins-10-tab">
                <div class="card">
                    <div class="technical-analysis-header">
                        <h2><i class="fas fa-coins"></i> ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø±</h2>
                        <div class="time-box">
                            <i class="fas fa-clock"></i>
                            <span id="last-update-time-10">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: -</span>
                            <span class="live-update-indicator blink" id="live-indicator-10">
                                <i class="fas fa-circle" style="font-size: 8px;"></i>
                                Ø²Ù†Ø¯Ù‡
                            </span>
                        </div>
                    </div>
                    
                    <div id="market-summary-10" class="alert-success">
                        <i class="fas fa-info-circle"></i>
                        <span id="summary-text-10">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±...</span>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ø±Ø²</th>
                                <th>Ù‚ÛŒÙ…Øª ÙØ¹Ù„ÛŒ</th>
                                <th>ØªØºÛŒÛŒØ± 24h</th>
                                <th>Ø³ÛŒÚ¯Ù†Ø§Ù„</th>
                                <th>Ø§Ø¹ØªÙ…Ø§Ø¯</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª Ù†ÙˆØ³Ø§Ù†</th>
                                <th>RSI</th>
                                <th>Ø§Ù‚Ø¯Ø§Ù…</th>
                            </tr>
                        </thead>
                        <tbody id="all-coins-list-10">
                            <!-- Ø§ÛŒÙ† Ø¨Ø®Ø´ ØªÙˆØ³Ø· Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-content" id="market-analysis-10-tab">
                <div class="card">
                    <h2><i class="fas fa-chart-bar"></i> ØªØ­Ù„ÛŒÙ„ Ú©Ù„ÛŒ Ø¨Ø§Ø²Ø§Ø± (10 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="market-analysis-content-10">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±...
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="swing-opportunities-10-tab">
                <div class="card">
                    <h2><i class="fas fa-bolt"></i> ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ (10 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="swing-opportunities-content-10">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ÛŒØ§ÙØªÙ† Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ...
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="risk-metrics-10-tab">
                <div class="card">
                    <h2><i class="fas fa-shield-alt"></i> Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú© Ø¨Ø§Ø²Ø§Ø± (10 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="risk-metrics-content-10">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú©...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² -->
        <div class="tab-container" id="coins-section-40" style="display: none;">
            <div class="tab-header">
                <button class="tab-btn active" data-tab="all-coins-40">
                    <i class="fas fa-list"></i> Ù„ÛŒØ³Øª 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±
                </button>
                <button class="tab-btn" data-tab="market-analysis-40">
                    <i class="fas fa-chart-pie"></i> ØªØ­Ù„ÛŒÙ„ Ú©Ù„ÛŒ Ø¨Ø§Ø²Ø§Ø±
                </button>
                <button class="tab-btn" data-tab="swing-opportunities-40">
                    <i class="fas fa-bolt"></i> ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ
                </button>
                <button class="tab-btn" data-tab="risk-metrics-40">
                    <i class="fas fa-shield-alt"></i> Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú©
                </button>
            </div>

            <div class="tab-content active" id="all-coins-40-tab">
                <div class="card">
                    <div class="technical-analysis-header">
                        <h2><i class="fas fa-coins"></i> ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø±</h2>
                        <div class="time-box">
                            <i class="fas fa-clock"></i>
                            <span id="last-update-time-40">Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: -</span>
                        </div>
                    </div>
                    
                    <div id="market-summary-40" class="alert-success">
                        <i class="fas fa-info-circle"></i>
                        <span id="summary-text-40">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±...</span>
                    </div>
                    
                    <table>
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Ø§Ø±Ø²</th>
                                <th>Ù‚ÛŒÙ…Øª ÙØ¹Ù„ÛŒ</th>
                                <th>ØªØºÛŒÛŒØ± 24h</th>
                                <th>Ø³ÛŒÚ¯Ù†Ø§Ù„</th>
                                <th>Ø§Ø¹ØªÙ…Ø§Ø¯</th>
                                <th>ÙˆØ¶Ø¹ÛŒØª Ù†ÙˆØ³Ø§Ù†</th>
                                <th>RSI</th>
                                <th>Ø§Ù‚Ø¯Ø§Ù…</th>
                            </tr>
                        </thead>
                        <tbody id="all-coins-list-40">
                            <!-- Ø§ÛŒÙ† Ø¨Ø®Ø´ ØªÙˆØ³Ø· Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="tab-content" id="market-analysis-40-tab">
                <div class="card">
                    <h2><i class="fas fa-chart-bar"></i> ØªØ­Ù„ÛŒÙ„ Ú©Ù„ÛŒ Ø¨Ø§Ø²Ø§Ø± (40 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="market-analysis-content-40">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±...
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="swing-opportunities-40-tab">
                <div class="card">
                    <h2><i class="fas fa-bolt"></i> ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ (40 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="swing-opportunities-content-40">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ÛŒØ§ÙØªÙ† Ø¨Ù‡ØªØ±ÛŒÙ† ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ...
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-content" id="risk-metrics-40-tab">
                <div class="card">
                    <h2><i class="fas fa-shield-alt"></i> Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú© Ø¨Ø§Ø²Ø§Ø± (40 Ø§Ø±Ø² Ø¨Ø±ØªØ±)</h2>
                    <div id="risk-metrics-content-40">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¹ÛŒØ§Ø±Ù‡Ø§ÛŒ Ø±ÛŒØ³Ú©...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªØ­Ù„ÛŒÙ„ ØªÚ©ÛŒ Ø§Ø±Ø² -->
        <div id="single-coin-section" style="display: none;">
            <div class="card">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                    <div>
                        <h2><i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²</h2>
                        <p style="color:var(--muted);margin-top:5px" id="single-coin-subtitle">ØªØ­Ù„ÛŒÙ„ Bitcoin (BTC) - ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ Ùˆ Ø¨Ù†ÛŒØ§Ø¯ÛŒ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§Ù…Ù„</p>
                    </div>
                    <button class="action-btn" onclick="backToMainPage()" style="width:auto;padding:10px 20px;">
                        <i class="fas fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
                    </button>
                </div>
                
                <div id="single-coin-content">
                    <!-- Ù…Ø­ØªÙˆØ§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² ØªÚ©ÛŒ -->
                </div>
            </div>
        </div>

        <!-- Ø¨Ø®Ø´ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ (Ø¬Ø¯ÛŒØ¯) -->
        <div id="advanced-analysis-section" style="display: none;">
            <div class="card">
                <div class="advanced-analysis-header">
                    <div>
                        <h2><i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h2>
                        <p style="color:var(--muted);margin-top:5px">Û· ÙˆÛŒÚ˜Ú¯ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ØªØµÙ…ÛŒÙ…â€ŒÚ¯ÛŒØ±ÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</p>
                    </div>
                    <button class="action-btn" onclick="backToSingleCoin()" style="width:auto;padding:10px 20px;">
                        <i class="fas fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØªØ­Ù„ÛŒÙ„ Ø§ØµÙ„ÛŒ
                    </button>
                </div>
                
                <div class="tab-container">
                    <div class="tab-header">
                        <button class="tab-btn active" data-tab="fibonacci-tab">
                            <i class="fas fa-ruler-combined"></i> Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ
                        </button>
                        <button class="tab-btn" data-tab="patterns-tab">
                            <i class="fas fa-shapes"></i> Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ
                        </button>
                        <button class="tab-btn" data-tab="volume-tab">
                            <i class="fas fa-chart-bar"></i> ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù…
                        </button>
                        <button class="tab-btn" data-tab="sr-tab">
                            <i class="fas fa-shield-alt"></i> Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª
                        </button>
                        <button class="tab-btn" data-tab="news-tab">
                            <i class="fas fa-newspaper"></i> Ø§Ø®Ø¨Ø§Ø±
                        </button>
                        <button class="tab-btn" data-tab="events-tab">
                            <i class="fas fa-calendar-alt"></i> Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
                        </button>
                        <button class="tab-btn" data-tab="onchain-tab">
                            <i class="fas fa-link"></i> Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ
                        </button>
                    </div>
                    
                    <div class="advanced-tab-content active" id="fibonacci-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-ruler-combined"></i> ØªØ­Ù„ÛŒÙ„ Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ</h3>
                            <div id="fibonacci-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="patterns-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-shapes"></i> Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ</h3>
                            <div id="patterns-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="volume-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-chart-bar"></i> ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h3>
                            <div id="volume-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="sr-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-shield-alt"></i> Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª Ùˆ Ù…Ù‚Ø§ÙˆÙ…Øª</h3>
                            <div id="sr-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª Ùˆ Ù…Ù‚Ø§ÙˆÙ…Øª...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="news-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-newspaper"></i> Ø§Ø®Ø¨Ø§Ø± Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</h3>
                            <div id="news-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø±...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="events-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-calendar-alt"></i> ØªÙ‚ÙˆÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§</h3>
                            <div id="events-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ø¢ØªÛŒ...
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="advanced-tab-content" id="onchain-tab">
                        <div class="analysis-section">
                            <h3><i class="fas fa-link"></i> ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ</h3>
                            <div id="onchain-content">
                                <div class="loading">
                                    <i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø±Ù†Ø§Ù…Ù‡ ====================
        const CONFIG = {
            TOP_COINS_COUNT_10: 10,
            TOP_COINS_COUNT_40: 40,
            UPDATE_INTERVAL: 30000,
            CACHE_DURATION: 60000,
            API_TIMEOUT: 15000,
            RETRY_DELAY: 3000,
            MAX_RETRIES: 5,
            CURRENT_MODE: 'top10'
        };

        // ==================== Ù…ØªØºÛŒØ±Ù‡Ø§ÛŒ Ø³Ø±Ø§Ø³Ø±ÛŒ ====================
        let allCoinsData10 = [];
        let allCoinsData40 = [];
        let marketData = null;
        let updateInterval = null;
        let currentCharts = [];
        let coinCache = new Map();
        let currentCoinId = null;

        // ==================== Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ú©Ù…Ú©ÛŒ ====================
        class Helpers {
            static formatNumber(num, decimals = 2) {
                if (num === undefined || num === null || isNaN(num)) return "0.00";
                return new Intl.NumberFormat('en-US', {
                    minimumFractionDigits: decimals,
                    maximumFractionDigits: decimals
                }).format(num);
            }
            
            static formatPrice(price) {
                if (price >= 1000) {
                    return `$${this.formatNumber(price, 0)}`;
                } else if (price >= 1) {
                    return `$${this.formatNumber(price, 2)}`;
                } else if (price >= 0.01) {
                    return `$${this.formatNumber(price, 4)}`;
                } else {
                    return `$${this.formatNumber(price, 6)}`;
                }
            }
            
            static getCurrentTime() {
                const now = new Date();
                const time = now.toLocaleTimeString('fa-IR');
                const date = now.toLocaleDateString('fa-IR');
                return { time, date, timestamp: now.getTime() };
            }
            
            static updateTimeDisplay() {
                const { time, date } = this.getCurrentTime();
                document.getElementById('current-time').innerHTML = 
                    `<i class="fas fa-clock"></i> ${time} - ${date}`;
            }
            
            static async sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            
            static getColorByValue(value, reverse = false) {
                if (value >= 70) return reverse ? 'var(--red)' : 'var(--green)';
                if (value >= 40) return 'var(--yellow)';
                return reverse ? 'var(--green)' : 'var(--red)';
            }
            
            static getChangeColor(change) {
                return change >= 0 ? 'var(--green)' : 'var(--red)';
            }
            
            static calculateVolatility(high, low, close) {
                if (!close || close === 0) return { level: 'Ù…ØªÙˆØ³Ø·', color: 'var(--yellow)' };
                const range = ((high - low) / close) * 100;
                if (range < 3) return { level: 'Ú©Ù…', color: 'var(--green)' };
                if (range > 8) return { level: 'Ø²ÛŒØ§Ø¯', color: 'var(--red)' };
                return { level: 'Ù…ØªÙˆØ³Ø·', color: 'var(--yellow)' };
            }
            
            static validatePriceData(data) {
                if (!data) return false;
                if (!data.price || data.price <= 0 || data.price > 1000000) return false;
                if (Math.abs(data.change24h) > 100) return false;
                return true;
            }
        }

        // ==================== Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ¶Ø¹ÛŒØª ====================
        class StatusManager {
            static show(message, type = 'info') {
                const statusBar = document.getElementById('status-bar');
                const statusMessage = document.getElementById('status-message');
                
                if (!statusBar || !statusMessage) return;
                
                statusBar.className = 'status-bar';
                statusBar.classList.add(`status-${type}`);
                statusMessage.textContent = message;
                statusBar.style.display = 'flex';
                
                if (type === 'info') {
                    setTimeout(() => {
                        if (statusBar.classList.contains('status-info')) {
                            statusBar.style.display = 'none';
                        }
                    }, 5000);
                }
            }
            
            static hide() {
                const statusBar = document.getElementById('status-bar');
                if (statusBar) {
                    statusBar.style.display = 'none';
                }
            }
        }

        // ==================== API Manager ====================
        class APIManager {
            static async fetchWithTimeout(url, options = {}, timeout = CONFIG.API_TIMEOUT) {
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), timeout);
                
                try {
                    const response = await fetch(url, {
                        ...options,
                        signal: controller.signal
                    });
                    clearTimeout(timeoutId);
                    
                    if (!response.ok) {
                        throw new Error(`Ø®Ø·Ø§ÛŒ API: ${response.status}`);
                    }
                    
                    return await response.json();
                } catch (error) {
                    clearTimeout(timeoutId);
                    throw error;
                }
            }
            
            static async getTopCoins(limit = CONFIG.TOP_COINS_COUNT_10) {
                try {
                    StatusManager.show(`Ø¯Ø±ÛŒØ§ÙØª Ù„ÛŒØ³Øª ${limit} Ø§Ø±Ø² Ø¨Ø±ØªØ±...`, 'info');
                    
                    const url = `https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=${limit}&page=1&sparkline=false&price_change_percentage=24h`;
                    
                    const data = await this.fetchWithTimeout(url);
                    
                    if (data && Array.isArray(data) && data.length > 0) {
                        StatusManager.show(`${data.length} Ø§Ø±Ø² Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯`, 'success');
                        return data;
                    } else {
                        throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒØ§ÛŒ Ø§Ø² API Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯');
                    }
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø² API:', error);
                    StatusManager.show('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§. Ù„Ø·ÙØ§ Ù…Ø¬Ø¯Ø¯ ØªÙ„Ø§Ø´ Ú©Ù†ÛŒØ¯.', 'error');
                    throw error;
                }
            }
            
            static async getCoinDetails(coinId) {
                const cacheKey = `coin_${coinId}`;
                const cached = coinCache.get(cacheKey);
                
                if (cached && (Date.now() - cached.timestamp) < CONFIG.CACHE_DURATION) {
                    return cached.data;
                }
                
                try {
                    const url = `https://api.coingecko.com/api/v3/coins/${coinId}?localization=false&tickers=false&market_data=true&community_data=false&developer_data=false&sparkline=true`;
                    
                    const data = await this.fetchWithTimeout(url);
                    
                    if (data) {
                        coinCache.set(cacheKey, {
                            data,
                            timestamp: Date.now()
                        });
                        
                        return data;
                    }
                } catch (error) {
                    console.warn(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¬Ø²Ø¦ÛŒØ§Øª ${coinId}:`, error);
                    throw error;
                }
                
                return null;
            }
            
            static async searchCoins(query) {
                if (!query || query.length < 2) return [];
                
                try {
                    const url = `https://api.coingecko.com/api/v3/search?query=${encodeURIComponent(query)}`;
                    const data = await this.fetchWithTimeout(url);
                    
                    if (data && data.coins) {
                        return data.coins.slice(0, 8);
                    }
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ:', error);
                }
                
                return [];
            }
            
            static async getCoinOHLC(coinId, days = 30) {
                try {
                    const url = `https://api.coingecko.com/api/v3/coins/${coinId}/ohlc?vs_currency=usd&days=${days}`;
                    const data = await this.fetchWithTimeout(url);
                    return data;
                } catch (error) {
                    console.warn(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª OHLC Ø¨Ø±Ø§ÛŒ ${coinId}:`, error);
                    return null;
                }
            }
            
            static async getCoinMarketData(coinId) {
                try {
                    const url = `https://api.coingecko.com/api/v3/coins/${coinId}/market_chart?vs_currency=usd&days=30&interval=daily`;
                    const data = await this.fetchWithTimeout(url);
                    return data;
                } catch (error) {
                    console.warn(`Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø¨Ø±Ø§ÛŒ ${coinId}:`, error);
                    return null;
                }
            }
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ ====================
        class TechnicalAnalysis {
            static calculateRSI(prices, period = 14) {
                if (!prices || prices.length < period + 1) return 50;
                
                let gains = [];
                let losses = [];
                
                for (let i = 1; i < prices.length; i++) {
                    let change = (prices[i] || 0) - (prices[i-1] || 0);
                    if (change >= 0) {
                        gains.push(change);
                        losses.push(0);
                    } else {
                        gains.push(0);
                        losses.push(Math.abs(change));
                    }
                }
                
                let avgGain = 0, avgLoss = 0;
                
                for (let i = 0; i < period; i++) {
                    avgGain += gains[i] || 0;
                    avgLoss += losses[i] || 0;
                }
                
                avgGain = avgGain / period;
                avgLoss = avgLoss / period;
                
                for (let i = period; i < gains.length; i++) {
                    avgGain = ((avgGain * (period-1)) + (gains[i] || 0)) / period;
                    avgLoss = ((avgLoss * (period-1)) + (losses[i] || 0)) / period;
                }
                
                if (avgLoss === 0) return 100;
                let rs = avgGain / avgLoss;
                return 100 - (100 / (1 + rs));
            }
            
            static calculateEMA(prices, period) {
                if (!prices || prices.length < period || period <= 0) return prices?.[prices.length-1] || 0;
                
                let sma = 0;
                for (let i = 0; i < period; i++) {
                    sma += prices[i] || 0;
                }
                sma = sma / period;
                
                let multiplier = 2/(period+1);
                let ema = sma;
                
                for (let i = period; i < prices.length; i++) {
                    ema = ((prices[i] || 0) - ema) * multiplier + ema;
                }
                return ema;
            }
            
            static calculateMACD(prices, fast = 12, slow = 26, signal = 9) {
                if (!prices || prices.length < slow) return {macd:0, signal:0, histogram:0};
                
                let fastEMA = TechnicalAnalysis.calculateEMA(prices, fast);
                let slowEMA = TechnicalAnalysis.calculateEMA(prices, slow);
                let macdLine = fastEMA - slowEMA;
                
                let macdValues = [];
                for (let i = slow-1; i < prices.length; i++) {
                    let fastE = TechnicalAnalysis.calculateEMA(prices.slice(0, i+1), fast);
                    let slowE = TechnicalAnalysis.calculateEMA(prices.slice(0, i+1), slow);
                    macdValues.push(fastE - slowE);
                }
                
                let signalLine = TechnicalAnalysis.calculateEMA(macdValues, signal);
                let histogram = macdLine - signalLine;
                
                return {
                    macd: macdLine,
                    signal: signalLine,
                    histogram: histogram || 0
                };
            }
            
            static calculateBollingerBands(prices, period = 20, stdDev = 2) {
                if (!prices || prices.length < period) {
                    const price = prices?.[prices.length-1] || 0;
                    return {upper:price, middle:price, lower:price, bandwidth:0};
                }
                
                let slice = prices.slice(-period);
                let mean = slice.reduce((a,b)=>a+(b||0),0)/slice.length;
                let variance = slice.reduce((sq,n)=>sq+Math.pow((n||0)-mean,2),0)/slice.length;
                let std = Math.sqrt(variance) || 0;
                
                return {
                    upper: mean + stdDev * std,
                    middle: mean,
                    lower: mean - stdDev * std,
                    bandwidth: ((mean + stdDev * std) - (mean - stdDev * std)) / mean * 100 || 0
                };
            }
            
            static calculateATR(highs, lows, closes, period = 14) {
                if (!closes || closes.length < 2) return 0;
                
                let trSum = 0;
                let trValues = [];
                
                for (let i = 1; i < closes.length; i++) {
                    let hl = Math.abs((highs[i] || 0) - (lows[i] || 0));
                    let hc = Math.abs((highs[i] || 0) - (closes[i-1] || 0));
                    let lc = Math.abs((lows[i] || 0) - (closes[i-1] || 0));
                    let tr = Math.max(hl, hc, lc);
                    trValues.push(tr);
                    
                    if (i < period) {
                        trSum += tr;
                    }
                }
                
                if (trValues.length < period) {
                    return trValues.length > 0 ? trSum/trValues.length : 0;
                }
                
                let atr = trSum;
                
                for (let i = period; i < trValues.length; i++) {
                    atr = ((atr * (period-1)) + trValues[i]) / period;
                }
                
                return atr;
            }
            
            static calculateStochastic(highs, lows, closes, kPeriod = 14, dPeriod = 3) {
                if (!closes || closes.length < kPeriod) return {k:50, d:50, oversold:false, overbought:false};
                
                let kValues = [];
                for (let i = kPeriod-1; i < closes.length; i++) {
                    let highSlice = highs.slice(i-kPeriod+1, i+1).map(h=>h||0);
                    let lowSlice = lows.slice(i-kPeriod+1, i+1).map(l=>l||0);
                    let high = Math.max(...highSlice);
                    let low = Math.min(...lowSlice);
                    
                    if (high === low) {
                        kValues.push(50);
                    } else {
                        let k = ((closes[i]||0)-low)/(high-low)*100;
                        kValues.push(k);
                    }
                }
                
                let dValues = [];
                for (let i = dPeriod-1; i < kValues.length; i++) {
                    let d = kValues.slice(i-dPeriod+1, i+1).reduce((a,b)=>a+b,0)/dPeriod;
                    dValues.push(d);
                }
                
                const lastK = kValues.length > 0 ? kValues[kValues.length-1] : 50;
                const lastD = dValues.length > 0 ? dValues[dValues.length-1] : 50;
                
                return {
                    k: lastK,
                    d: lastD,
                    oversold: lastK < 20,
                    overbought: lastK > 80
                };
            }
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ ÙØ§Ø±Ø³ÛŒ ====================
        class PersianAnalysis {
            static getRSIAnalysis(rsi) {
                if (rsi === undefined || rsi === null) rsi = 50;
                let analysis = "";
                if (rsi < 30) analysis = `RSI Ø¯Ø± Ø§Ø´Ø¨Ø§Ø¹ ÙØ±ÙˆØ´ Ø§Ø³Øª <span class="indicator-value">${rsi.toFixed(1)}</span>Ø› Ø§Ø­ØªÙ…Ø§Ù„ ÙˆØ§Ú©Ù†Ø´ ØµØ¹ÙˆØ¯ÛŒ Ù‚ÙˆÛŒ`;
                else if (rsi < 45) analysis = `RSI Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ ÙØ±ÙˆØ´ Ø§Ø³Øª <span class="indicator-value">${rsi.toFixed(1)}</span>Ø› ÙØ´Ø§Ø± ÙØ±ÙˆØ´ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯`;
                else if (rsi < 55) analysis = `RSI Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø®Ù†Ø«ÛŒ Ø§Ø³Øª <span class="indicator-value">${rsi.toFixed(1)}</span>Ø› Ø¨Ø§Ø²Ø§Ø± Ù…ØªØ¹Ø§Ø¯Ù„`;
                else if (rsi < 70) analysis = `RSI Ø¯Ø± Ù…Ø­Ø¯ÙˆØ¯Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø³Øª <span class="indicator-value">${rsi.toFixed(1)}</span>Ø› ÙØ´Ø§Ø± Ø®Ø±ÛŒØ¯ ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯`;
                else analysis = `RSI Ø¯Ø± Ø§Ø´Ø¨Ø§Ø¹ Ø®Ø±ÛŒØ¯ Ø§Ø³Øª <span class="indicator-value">${rsi.toFixed(1)}</span>Ø› Ø§Ø­ØªÙ…Ø§Ù„ Ø§ØµÙ„Ø§Ø­ Ù‚ÛŒÙ…Øª`;
                return analysis;
            }
            
            static getMACDAnalysis(macd) {
                if (!macd || macd.histogram === undefined) return `MACD: Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ú©Ø§ÙÛŒ`;
                
                const hist = macd.histogram || 0;
                let analysis = "";
                
                if (hist > 0) {
                    analysis = `MACD ØµØ¹ÙˆØ¯ÛŒ <span class="indicator-value">${hist.toFixed(4)}</span>Ø› Ù‚Ø¯Ø±Øª Ø®Ø±ÛŒØ¯Ø§Ø±Ø§Ù†`;
                } else if (hist < 0) {
                    analysis = `MACD Ù†Ø²ÙˆÙ„ÛŒ <span class="indicator-value">${Math.abs(hist).toFixed(4)}</span>Ø› Ù‚Ø¯Ø±Øª ÙØ±ÙˆØ´Ù†Ø¯Ú¯Ø§Ù†`;
                } else {
                    analysis = `MACD Ø®Ù†Ø«ÛŒ <span class="indicator-value">${hist.toFixed(4)}</span>Ø› Ø¨Ø§Ø²Ø§Ø± Ø¯Ø± ØªØ¹Ø§Ø¯Ù„`;
                }
                return analysis;
            }
            
            static getTrendAnalysis(ema9, ema20, ema50, price) {
                ema9 = ema9 || 0; ema20 = ema20 || 0; ema50 = ema50 || 0; price = price || 0;
                
                let analysis = "";
                if (ema9 > ema20 && ema20 > ema50 && price > ema9) {
                    analysis = `Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ Ù‚ÙˆÛŒ | EMA9: $${ema9.toFixed(2)} > EMA20: $${ema20.toFixed(2)} > EMA50: $${ema50.toFixed(2)}`;
                } else if (ema9 < ema20 && ema20 < ema50 && price < ema9) {
                    analysis = `Ø±ÙˆÙ†Ø¯ Ù†Ø²ÙˆÙ„ÛŒ Ù‚ÙˆÛŒ | EMA9: $${ema9.toFixed(2)} < EMA20: $${ema20.toFixed(2)} < EMA50: $${ema50.toFixed(2)}`;
                } else if (ema9 > ema20 && price > ema9) {
                    analysis = `Ø±ÙˆÙ†Ø¯ Ú©ÙˆØªØ§Ù‡ ØµØ¹ÙˆØ¯ÛŒ | EMA9: $${ema9.toFixed(2)} > EMA20: $${ema20.toFixed(2)}`;
                } else if (ema9 < ema20 && price < ema9) {
                    analysis = `Ø±ÙˆÙ†Ø¯ Ú©ÙˆØªØ§Ù‡ Ù†Ø²ÙˆÙ„ÛŒ | EMA9: $${ema9.toFixed(2)} < EMA20: $${ema20.toFixed(2)}`;
                } else {
                    analysis = `Ø±ÙˆÙ†Ø¯ Ø®Ù†Ø«ÛŒ | EMA9: $${ema9.toFixed(2)} | EMA20: $${ema20.toFixed(2)} | EMA50: $${ema50.toFixed(2)}`;
                }
                return analysis;
            }
            
            static getVolatilityAnalysis(atr, price) {
                atr = atr || 0; price = price || 0;
                const ratio = price > 0 ? (atr/price)*100 : 0;
                let vol = "Ù…ØªÙˆØ³Ø·";
                if (ratio < 3) vol = "Ú©Ù…";
                if (ratio > 8) vol = "Ø²ÛŒØ§Ø¯";
                return `Ù†ÙˆØ³Ø§Ù† ${vol} | ATR: $${atr.toFixed(2)} (${ratio.toFixed(2)}%)`;
            }
            
            static getBollingerAnalysis(price, bb) {
                price = price || 0;
                if (!bb) return `Ø¨Ø§Ù†Ø¯ Ø¨ÙˆÙ„ÛŒÙ†Ú¯Ø±: Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ú©Ø§ÙÛŒ`;
                
                let position = "";
                if (price > bb.upper) position = `Ø¨Ø§Ù„Ø§ÛŒ Ø¨Ø§Ù†Ø¯ Ø¨Ø§Ù„Ø§ <span class="indicator-value">${bb.upper>0?((price/bb.upper-1)*100).toFixed(2):0}%</span>`;
                else if (price < bb.lower) position = `Ø²ÛŒØ± Ø¨Ø§Ù†Ø¯ Ù¾Ø§ÛŒÛŒÙ† <span class="indicator-value">${price>0?((bb.lower/price-1)*100).toFixed(2):0}%</span>`;
                else if (price > bb.middle) position = `Ù†ÛŒÙ…Ù‡ Ø¨Ø§Ù„Ø§ÛŒÛŒ Ø¨Ø§Ù†Ø¯ <span class="indicator-value">${bb.bandwidth.toFixed(2)}%</span>`;
                else position = `Ù†ÛŒÙ…Ù‡ Ù¾Ø§ÛŒÛŒÙ†ÛŒ Ø¨Ø§Ù†Ø¯ <span class="indicator-value">${bb.bandwidth.toFixed(2)}%</span>`;
                return `Ù‚ÛŒÙ…Øª Ø¯Ø± ${position} | Ø¨Ø§Ù†Ø¯: $${bb.upper.toFixed(2)} - $${bb.lower.toFixed(2)}`;
            }
            
            static getStochasticAnalysis(stoch) {
                if (!stoch) return `Ø§Ø³ØªÙˆÚ©Ø§Ø³ØªÛŒÚ©: Ø¯Ø§Ø¯Ù‡ Ù†Ø§Ú©Ø§ÙÛŒ`;
                
                const k = stoch.k || 50;
                const d = stoch.d || 50;
                let analysis = "";
                
                if (stoch.oversold) analysis = `Ø§Ø³ØªÙˆÚ©Ø§Ø³ØªÛŒÚ© Ø§Ø´Ø¨Ø§Ø¹ ÙØ±ÙˆØ´ <span class="indicator-value">K:${k.toFixed(1)} D:${d.toFixed(1)}</span>`;
                else if (stoch.overbought) analysis = `Ø§Ø³ØªÙˆÚ©Ø§Ø³ØªÛŒÚ© Ø§Ø´Ø¨Ø§Ø¹ Ø®Ø±ÛŒØ¯ <span class="indicator-value">K:${k.toFixed(1)} D:${d.toFixed(1)}</span>`;
                else if (k > d) analysis = `Ø§Ø³ØªÙˆÚ©Ø§Ø³ØªÛŒÚ© ØµØ¹ÙˆØ¯ÛŒ <span class="indicator-value">K:${k.toFixed(1)} > D:${d.toFixed(1)}</span>`;
                else analysis = `Ø§Ø³ØªÙˆÚ©Ø§Ø³ØªÛŒÚ© Ù†Ø²ÙˆÙ„ÛŒ <span class="indicator-value">K:${k.toFixed(1)} < D:${d.toFixed(1)}</span>`;
                return analysis;
            }
        }

        // ==================== Ø³ÛŒØ³ØªÙ… Ø§Ù…ØªÛŒØ§Ø²Ø¯Ù‡ÛŒ ====================
        class ScoringSystem {
            static calculateScore(data) {
                let score = 50;
                
                const rsi = data.rsi || 50;
                if (rsi < 30) score += 20;
                else if (rsi < 45) score += 10;
                else if (rsi > 70) score -= 20;
                else if (rsi > 55) score -= 10;
                
                const ema9 = data.ema9 || 0, ema20 = data.ema20 || 0, ema50 = data.ema50 || 0;
                if (ema9 > ema20 && ema20 > ema50) score += 20;
                else if (ema9 < ema20 && ema20 < ema50) score -= 15;
                
                const macdHist = data.macd?.histogram || 0;
                if (macdHist > 0) score += 15;
                else if (macdHist < 0) score -= 15;
                
                const price = data.price || 1;
                const atr = data.atr || 0;
                const volatilityRatio = atr/price;
                
                if (volatilityRatio > 0.025 && rsi > 30 && rsi < 70) score += 15;
                else if (volatilityRatio < 0.01 && (rsi <= 30 || rsi >= 70)) score -= 10;
                
                if (data.stoch?.oversold) score += 10;
                else if (data.stoch?.overbought) score -= 10;
                
                if (price < data.bb?.lower) score += 10;
                else if (price > data.bb?.upper) score -= 10;
                
                return Math.max(0, Math.min(100, score));
            }
            
            static getSignal(score) {
                if (score >= 70) return {signal:"Ø®Ø±ÛŒØ¯", class:"buy"};
                if (score >= 60) return {signal:"Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ", class:"hold"};
                if (score >= 40) return {signal:"ØµØ¨Ø±", class:"wait"};
                return {signal:"ÙØ±ÙˆØ´", class:"sell"};
            }
            
            static getSwingStatus(data) {
                if (!data) return {status:"Ø¶Ø¹ÛŒÙ", color:"red"};
                
                let factors = 0;
                const price = data.price || 1;
                const rsi = data.rsi || 50;
                
                if ((data.atr || 0)/price > 0.02) factors++;
                if (Math.abs(rsi-50) > 15) factors++;
                if ((data.macd?.histogram || 0) > 0) factors++;
                
                if (factors >= 3) return {status:"Ø¹Ø§Ù„ÛŒ", color:"green"};
                if (factors >= 2) return {status:"Ù…ØªÙˆØ³Ø·", color:"yellow"};
                return {status:"Ø¶Ø¹ÛŒÙ", color:"red"};
            }
        }

        // ==================== ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ ====================

        // Û±. ØªØ­Ù„ÛŒÙ„ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ
        class FibonacciAnalysis {
            static calculateFibonacciLevels(high, low) {
                if (!high || !low || high <= low) return null;
                
                const diff = high - low;
                return {
                    '0%': low,
                    '23.6%': low + diff * 0.236,
                    '38.2%': low + diff * 0.382,
                    '50%': low + diff * 0.5,
                    '61.8%': low + diff * 0.618,
                    '78.6%': low + diff * 0.786,
                    '100%': high,
                    '127.2%': high + diff * 0.272,
                    '161.8%': high + diff * 0.618
                };
            }
            
            static renderFibonacci(currentPrice, high, low) {
                const fibLevels = this.calculateFibonacciLevels(high, low);
                
                if (!fibLevels) {
                    return '<p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ø§Ú©Ø§ÙÛŒ Ø¨Ø±Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ</p>';
                }
                
                let html = '<div class="fibonacci-levels">';
                Object.entries(fibLevels).forEach(([level, value]) => {
                    const distance = ((currentPrice - value) / currentPrice * 100).toFixed(2);
                    const isClose = Math.abs(distance) < 3;
                    html += `
                        <div class="fib-level ${isClose ? 'active' : ''}">
                            <span class="fib-label">${level}</span>
                            <span class="fib-value">$${value.toFixed(2)}</span>
                            <span class="fib-distance ${distance >= 0 ? 'up' : 'down'}">
                                ${distance >= 0 ? '+' : ''}${distance}%
                            </span>
                        </div>
                    `;
                });
                html += '</div>';
                
                // ØªØ­Ù„ÛŒÙ„
                html += '<div class="analysis-box" style="margin-top: 15px;">';
                if (currentPrice < fibLevels['38.2%']) {
                    html += '<div class="alert-success">Ù‚ÛŒÙ…Øª Ø¯Ø± Ø³Ø·Ø­ Ø¨Ø§Ø²Ú¯Ø´Øª ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ 38.2% - Ù…Ù†Ø·Ù‚Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>';
                } else if (currentPrice > fibLevels['61.8%']) {
                    html += '<div class="alert-warning">Ù‚ÛŒÙ…Øª Ø¯Ø± Ø³Ø·Ø­ Ø¨Ø§Ø²Ú¯Ø´Øª ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ 61.8% - Ù…Ù†Ø·Ù‚Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>';
                }
                html += '</div>';
                
                return html;
            }
        }

        // Û². Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ
        class PatternRecognition {
            static detectPatterns(prices) {
                if (!prices || prices.length < 20) return [];
                
                const patterns = [];
                const recentPrices = prices.slice(-20);
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÛŒ Ø³Ø± Ùˆ Ø´Ø§Ù†Ù‡
                if (this.isHeadAndShoulders(recentPrices)) {
                    patterns.push({
                        name: 'Ø³Ø± Ùˆ Ø´Ø§Ù†Ù‡',
                        type: 'Ø¨Ø§Ø²Ú¯Ø´ØªÛŒ',
                        direction: 'Ù†Ø²ÙˆÙ„ÛŒ',
                        confidence: 75
                    });
                }
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÛŒ Ø¯Ùˆ Ù‚Ù„Ù‡
                if (this.isDoubleTop(recentPrices)) {
                    patterns.push({
                        name: 'Ø¯Ùˆ Ù‚Ù„Ù‡',
                        type: 'Ø¨Ø§Ø²Ú¯Ø´ØªÛŒ',
                        direction: 'Ù†Ø²ÙˆÙ„ÛŒ',
                        confidence: 70
                    });
                }
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÛŒ Ø¯Ùˆ Ø¯Ø±Ù‡
                if (this.isDoubleBottom(recentPrices)) {
                    patterns.push({
                        name: 'Ø¯Ùˆ Ø¯Ø±Ù‡',
                        type: 'Ø¨Ø§Ø²Ú¯Ø´ØªÛŒ',
                        direction: 'ØµØ¹ÙˆØ¯ÛŒ',
                        confidence: 70
                    });
                }
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø«Ù„Ø«
                const triangleType = this.isTriangle(recentPrices);
                if (triangleType) {
                    patterns.push({
                        name: 'Ù…Ø«Ù„Ø«',
                        type: 'Ø§Ø¯Ø§Ù…Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ù‡',
                        direction: triangleType,
                        confidence: 65
                    });
                }
                
                return patterns;
            }
            
            static isHeadAndShoulders(prices) {
                if (prices.length < 7) return false;
                
                // Ù…Ù†Ø·Ù‚ Ø³Ø§Ø¯Ù‡â€ŒØ´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ´Ø®ÛŒØµ Ø§Ù„Ú¯ÙˆÛŒ Ø³Ø± Ùˆ Ø´Ø§Ù†Ù‡
                const mid = Math.floor(prices.length / 2);
                const leftShoulder = prices[mid - 3];
                const head = prices[mid];
                const rightShoulder = prices[mid + 3];
                
                return head > leftShoulder && head > rightShoulder && 
                       Math.abs(leftShoulder - rightShoulder) < leftShoulder * 0.1;
            }
            
            static isDoubleTop(prices) {
                if (prices.length < 6) return false;
                
                const peak1 = Math.max(...prices.slice(0, 3));
                const peak2 = Math.max(...prices.slice(3, 6));
                
                return Math.abs(peak1 - peak2) < peak1 * 0.05;
            }
            
            static isDoubleBottom(prices) {
                if (prices.length < 6) return false;
                
                const bottom1 = Math.min(...prices.slice(0, 3));
                const bottom2 = Math.min(...prices.slice(3, 6));
                
                return Math.abs(bottom1 - bottom2) < bottom1 * 0.05;
            }
            
            static isTriangle(prices) {
                if (prices.length < 10) return null;
                
                // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ù„Ú¯ÙˆÛŒ Ù…Ø«Ù„Ø«
                const firstHalf = prices.slice(0, 5);
                const secondHalf = prices.slice(5, 10);
                
                const firstRange = Math.max(...firstHalf) - Math.min(...firstHalf);
                const secondRange = Math.max(...secondHalf) - Math.min(...secondHalf);
                
                if (secondRange < firstRange * 0.7) {
                    const firstAvg = firstHalf.reduce((a, b) => a + b, 0) / firstHalf.length;
                    const secondAvg = secondHalf.reduce((a, b) => a + b, 0) / secondHalf.length;
                    
                    if (secondAvg > firstAvg) return 'ØµØ¹ÙˆØ¯ÛŒ';
                    if (secondAvg < firstAvg) return 'Ù†Ø²ÙˆÙ„ÛŒ';
                }
                
                return null;
            }
            
            static renderPatterns(patterns) {
                if (!patterns || patterns.length === 0) {
                    return '<p>Ù‡ÛŒÚ† Ø§Ù„Ú¯ÙˆÛŒ Ù‚ÛŒÙ…ØªÛŒ ÙˆØ§Ø¶Ø­ÛŒ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ø´Ø¯.</p>';
                }
                
                let html = '<div class="patterns-container">';
                patterns.forEach(pattern => {
                    const patternClass = pattern.direction === 'ØµØ¹ÙˆØ¯ÛŒ' ? 'pattern-buy' : 
                                        pattern.direction === 'Ù†Ø²ÙˆÙ„ÛŒ' ? 'pattern-sell' : 'pattern-neutral';
                    html += `
                        <div class="pattern-badge-advanced ${patternClass}">
                            <i class="fas fa-chart-area"></i>
                            ${pattern.name} (${pattern.type}) - Ø§Ø¹ØªÙ…Ø§Ø¯: ${pattern.confidence}%
                        </div>
                    `;
                });
                html += '</div>';
                
                return html;
            }
        }

        // Û³. ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª - Ú©Ø§Ù…Ù„Ø§Ù‹ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
        class VolumeAnalysis {
            static async analyzeVolume(coinId) {
                try {
                    const marketData = await APIManager.getCoinMarketData(coinId);
                    
                    if (!marketData || !marketData.total_volumes || marketData.total_volumes.length === 0) {
                        return '<p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ø¬Ù… Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª.</p>';
                    }
                    
                    const volumes = marketData.total_volumes.map(v => v[1] || 0);
                    const prices = marketData.prices.map(p => p[1] || 0);
                    
                    if (volumes.length < 10) {
                        return '<p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ø¬Ù… Ù†Ø§Ú©Ø§ÙÛŒ</p>';
                    }
                    
                    const recentVolumes = volumes.slice(-20);
                    const recentPrices = prices.slice(-20);
                    const avgVolume = recentVolumes.reduce((a, b) => a + b, 0) / recentVolumes.length;
                    const currentVolume = recentVolumes[recentVolumes.length - 1] || recentVolumes[recentVolumes.length - 2];
                    const volumeRatio = avgVolume > 0 ? currentVolume / avgVolume : 1;
                    
                    let html = '<div class="volume-analysis">';
                    html += '<div class="volume-metrics">';
                    html += `
                        <div class="volume-metric">
                            <div class="volume-metric-label">Ø­Ø¬Ù… ÙØ¹Ù„ÛŒ</div>
                            <div class="volume-metric-value">${this.formatVolume(currentVolume)}</div>
                        </div>
                        <div class="volume-metric">
                            <div class="volume-metric-label">Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø­Ø¬Ù…</div>
                            <div class="volume-metric-value">${this.formatVolume(avgVolume)}</div>
                        </div>
                        <div class="volume-metric">
                            <div class="volume-metric-label">Ù†Ø³Ø¨Øª Ø­Ø¬Ù…</div>
                            <div class="volume-metric-value">${volumeRatio.toFixed(2)}x</div>
                        </div>
                    `;
                    html += '</div>';
                    
                    // ØªØ­Ù„ÛŒÙ„
                    html += '<div class="analysis-box" style="margin-top: 15px;">';
                    if (volumeRatio > 1.5) {
                        html += '<div class="alert-success">Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø§Ù„Ø§ - ØªØ£ÛŒÛŒØ¯ Ù‚Ø¯Ø±Øª Ø­Ø±Ú©Øª Ù‚ÛŒÙ…Øª</div>';
                    } else if (volumeRatio < 0.5) {
                        html += '<div class="alert-warning">Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù¾Ø§ÛŒÛŒÙ† - Ø­Ø±Ú©Øª Ù‚ÛŒÙ…Øª Ø¶Ø¹ÛŒÙ</div>';
                    }
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ§Ú¯Ø±Ø§ÛŒÛŒ Ø­Ø¬Ù… Ùˆ Ù‚ÛŒÙ…Øª
                    if (recentPrices.length >= 5 && recentVolumes.length >= 5) {
                        const priceChange = ((recentPrices[recentPrices.length-1] - recentPrices[recentPrices.length-5]) / recentPrices[recentPrices.length-5] * 100).toFixed(2);
                        const volumeChange = ((recentVolumes[recentVolumes.length-1] - recentVolumes[recentVolumes.length-5]) / recentVolumes[recentVolumes.length-5] * 100).toFixed(2);
                        
                        if (parseFloat(priceChange) > 5 && parseFloat(volumeChange) < -10) {
                            html += '<div class="alert-danger">ÙˆØ§Ú¯Ø±Ø§ÛŒÛŒ Ù…Ù†ÙÛŒ Ø­Ø¬Ù… Ùˆ Ù‚ÛŒÙ…Øª - Ø§Ø­ØªÙ…Ø§Ù„ Ø§ØµÙ„Ø§Ø­</div>';
                        } else if (parseFloat(priceChange) < -5 && parseFloat(volumeChange) > 10) {
                            html += '<div class="alert-success">ÙˆØ§Ú¯Ø±Ø§ÛŒÛŒ Ù…Ø«Ø¨Øª Ø­Ø¬Ù… Ùˆ Ù‚ÛŒÙ…Øª - Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ø§Ø²Ú¯Ø´Øª</div>';
                        }
                    }
                    
                    html += '</div></div>';
                    
                    return html;
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù…:', error);
                    return '<p>Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø­Ø¬Ù…</p>';
                }
            }
            
            static formatVolume(volume) {
                if (volume >= 1e9) return `${(volume / 1e9).toFixed(2)}B`;
                if (volume >= 1e6) return `${(volume / 1e6).toFixed(2)}M`;
                if (volume >= 1e3) return `${(volume / 1e3).toFixed(2)}K`;
                return volume.toFixed(2);
            }
        }

        // Û´. Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª
        class SupportResistance {
            static identifyLevels(prices, sensitivity = 0.02) {
                if (!prices || prices.length < 20) return { supports: [], resistances: [] };
                
                const supports = [];
                const resistances = [];
                const windowSize = 5;
                
                // Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ú†Ø±Ø®Ø´
                for (let i = windowSize; i < prices.length - windowSize; i++) {
                    const windowBefore = prices.slice(i - windowSize, i);
                    const windowAfter = prices.slice(i + 1, i + windowSize + 1);
                    const current = prices[i];
                    
                    // Ù…Ù‚Ø§ÙˆÙ…Øª
                    if (current > Math.max(...windowBefore) && current > Math.max(...windowAfter)) {
                        resistances.push({
                            price: current,
                            strength: this.calculateStrength(prices, current, 'resistance')
                        });
                    }
                    
                    // Ø­Ù…Ø§ÛŒØª
                    if (current < Math.min(...windowBefore) && current < Math.min(...windowAfter)) {
                        supports.push({
                            price: current,
                            strength: this.calculateStrength(prices, current, 'support')
                        });
                    }
                }
                
                // Ú¯Ø±ÙˆÙ‡â€ŒØ¨Ù†Ø¯ÛŒ Ø³Ø·ÙˆØ­ Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ù‡Ù…
                return {
                    supports: this.groupLevels(supports, sensitivity).slice(0, 5),
                    resistances: this.groupLevels(resistances, sensitivity).slice(0, 5)
                };
            }
            
            static calculateStrength(prices, level, type) {
                let touches = 0;
                const tolerance = level * 0.01;
                
                for (let price of prices) {
                    if (Math.abs(price - level) <= tolerance) {
                        touches++;
                    }
                }
                
                return Math.min(100, touches * 20);
            }
            
            static groupLevels(levels, sensitivity) {
                const grouped = [];
                
                levels.forEach(level => {
                    let found = false;
                    for (let group of grouped) {
                        if (Math.abs(level.price - group.price) <= group.price * sensitivity) {
                            group.price = (group.price + level.price) / 2;
                            group.strength = Math.max(group.strength, level.strength);
                            found = true;
                            break;
                        }
                    }
                    if (!found) {
                        grouped.push({ ...level });
                    }
                });
                
                return grouped.sort((a, b) => b.strength - a.strength);
            }
            
            static renderLevels(currentPrice, supports, resistances) {
                let html = '<div class="sr-levels-container">';
                
                // Ù…Ù‚Ø§ÙˆÙ…Øªâ€ŒÙ‡Ø§
                resistances.forEach((res, index) => {
                    const distance = ((res.price - currentPrice) / currentPrice * 100).toFixed(2);
                    if (index < 3) {
                        html += `
                            <div class="sr-level resistance">
                                <span class="sr-label">Ù…Ù‚Ø§ÙˆÙ…Øª ${index + 1}</span>
                                <span class="sr-price">$${res.price.toFixed(2)}</span>
                                <span class="sr-distance">+${distance}%</span>
                                <div class="sr-strength">
                                    <div class="sr-strength-bar" style="width: ${res.strength}%"></div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                // Ù‚ÛŒÙ…Øª ÙØ¹Ù„ÛŒ
                html += `
                    <div class="sr-level current">
                        <span class="sr-label">Ù‚ÛŒÙ…Øª ÙØ¹Ù„ÛŒ</span>
                        <span class="sr-price">$${currentPrice.toFixed(2)}</span>
                    </div>
                `;
                
                // Ø­Ù…Ø§ÛŒØªâ€ŒÙ‡Ø§
                supports.forEach((sup, index) => {
                    const distance = ((currentPrice - sup.price) / currentPrice * 100).toFixed(2);
                    if (index < 3) {
                        html += `
                            <div class="sr-level support">
                                <span class="sr-label">Ø­Ù…Ø§ÛŒØª ${index + 1}</span>
                                <span class="sr-price">$${sup.price.toFixed(2)}</span>
                                <span class="sr-distance">-${distance}%</span>
                                <div class="sr-strength">
                                    <div class="sr-strength-bar" style="width: ${sup.strength}%"></div>
                                </div>
                            </div>
                        `;
                    }
                });
                
                html += '</div>';
                
                // ØªØ­Ù„ÛŒÙ„
                html += '<div class="analysis-box" style="margin-top: 15px;">';
                const nearestSupport = supports[0];
                const nearestResistance = resistances[0];
                
                if (nearestSupport && nearestResistance) {
                    const supportDistance = ((currentPrice - nearestSupport.price) / currentPrice * 100).toFixed(2);
                    const resistanceDistance = ((nearestResistance.price - currentPrice) / currentPrice * 100).toFixed(2);
                    
                    html += `<p>Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ø­Ù…Ø§ÛŒØª: $${nearestSupport.price.toFixed(2)} (${supportDistance}% Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±)</p>`;
                    html += `<p>Ù†Ø²Ø¯ÛŒÚ©â€ŒØªØ±ÛŒÙ† Ù…Ù‚Ø§ÙˆÙ…Øª: $${nearestResistance.price.toFixed(2)} (${resistanceDistance}% Ø¨Ø§Ù„Ø§ØªØ±)</p>`;
                    
                    if (parseFloat(supportDistance) < 2) {
                        html += '<div class="alert-success">Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ø­Ù…Ø§ÛŒØª Ù‚ÙˆÛŒ - Ù…Ù†Ø·Ù‚Ù‡ Ø®Ø±ÛŒØ¯ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>';
                    } else if (parseFloat(resistanceDistance) < 2) {
                        html += '<div class="alert-warning">Ù†Ø²Ø¯ÛŒÚ© Ø¨Ù‡ Ù…Ù‚Ø§ÙˆÙ…Øª Ù‚ÙˆÛŒ - Ù…Ù†Ø·Ù‚Ù‡ ÙØ±ÙˆØ´ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>';
                    }
                }
                html += '</div>';
                
                return html;
            }
        }

        // Ûµ. Ø§Ø®Ø¨Ø§Ø± Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ
        class NewsIntegration {
            static async getNews(coinName) {
                try {
                    // Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² API Ø±Ø§ÛŒÚ¯Ø§Ù† Ø¨Ø±Ø§ÛŒ Ø§Ø®Ø¨Ø§Ø± (CryptoCompare)
                    const response = await fetch(`https://min-api.cryptocompare.com/data/v2/news/?categories=${coinName}&excludeCategories=Sponsored`);
                    const data = await response.json();
                    
                    if (data.Data && data.Data.length > 0) {
                        return data.Data.slice(0, 5).map(item => ({
                            title: item.title,
                            source: item.source,
                            time: this.formatTime(item.published_on * 1000),
                            sentiment: this.analyzeSentiment(item.title),
                            url: item.url
                        }));
                    }
                    
                    return [];
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø§Ø®Ø¨Ø§Ø±:', error);
                    return [];
                }
            }
            
            static formatTime(timestamp) {
                const now = Date.now();
                const diff = now - timestamp;
                
                if (diff < 3600000) return `${Math.floor(diff / 60000)} Ø¯Ù‚ÛŒÙ‚Ù‡ Ù¾ÛŒØ´`;
                if (diff < 86400000) return `${Math.floor(diff / 3600000)} Ø³Ø§Ø¹Øª Ù¾ÛŒØ´`;
                return `${Math.floor(diff / 86400000)} Ø±ÙˆØ² Ù¾ÛŒØ´`;
            }
            
            static analyzeSentiment(title) {
                const positive = ['bullish', 'up', 'rise', 'gain', 'positive', 'surge', 'rally'];
                const negative = ['bearish', 'down', 'fall', 'drop', 'negative', 'crash', 'decline'];
                
                const lowerTitle = title.toLowerCase();
                
                if (positive.some(word => lowerTitle.includes(word))) return 'positive';
                if (negative.some(word => lowerTitle.includes(word))) return 'negative';
                return 'neutral';
            }
            
            static renderNews(news) {
                if (!news || news.length === 0) {
                    return '<p>Ù‡ÛŒÚ† Ø®Ø¨Ø±ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                }
                
                let html = '<div class="news-container">';
                news.forEach((item, index) => {
                    const sentimentClass = `news-sentiment-${item.sentiment}`;
                    html += `
                        <div class="news-item">
                            <div class="news-header">
                                <span class="news-source">${item.source}</span>
                                <span class="news-time">${item.time}</span>
                                <span class="news-sentiment ${sentimentClass}">${item.sentiment}</span>
                            </div>
                            <div class="news-title">${item.title}</div>
                            <a href="${item.url}" target="_blank" class="news-link">Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø§Ù…Ù„ Ø®Ø¨Ø±</a>
                        </div>
                    `;
                });
                html += '</div>';
                
                return html;
            }
        }

        // Û¶. Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
        class EventsCalendar {
            static async getEvents(coinId) {
                try {
                    const url = `https://api.coingecko.com/api/v3/coins/${coinId}?localization=false&tickers=false&market_data=false&community_data=true&developer_data=false&sparkline=false`;
                    const data = await APIManager.fetchWithTimeout(url);
                    
                    if (data.community_data) {
                        const events = [];
                        
                        if (data.links.twitter_screen_name) {
                            events.push({
                                title: 'ØªÙˆØ¦ÛŒØªØ± Ø±Ø³Ù…ÛŒ',
                                date: 'Ù…Ø³ØªÙ…Ø±',
                                daysLeft: 0,
                                importance: 'medium',
                                type: 'Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒ'
                            });
                        }
                        
                        if (data.links.official_forum_url) {
                            events.push({
                                title: 'Ø§Ù†Ø¬Ù…Ù† Ø±Ø³Ù…ÛŒ',
                                date: 'Ù…Ø³ØªÙ…Ø±',
                                daysLeft: 0,
                                importance: 'medium',
                                type: 'Ø§Ø¬ØªÙ…Ø§Ø¹ÛŒ'
                            });
                        }
                        
                        return events;
                    }
                    
                    return [];
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§:', error);
                    return [];
                }
            }
            
            static renderEvents(events) {
                if (!events || events.length === 0) {
                    return '<p>Ù‡ÛŒÚ† Ø±ÙˆÛŒØ¯Ø§Ø¯ÛŒ ÛŒØ§ÙØª Ù†Ø´Ø¯.</p>';
                }
                
                let html = '<div class="events-container">';
                events.forEach(event => {
                    const importanceClass = `event-importance-${event.importance}`;
                    html += `
                        <div class="event-item ${importanceClass}">
                            <div class="event-date">
                                <span class="event-day">${event.date}</span>
                                <span class="event-days-left">${event.daysLeft} Ø±ÙˆØ² Ù…Ø§Ù†Ø¯Ù‡</span>
                            </div>
                            <div class="event-content">
                                <div class="event-title">${event.title}</div>
                                <div class="event-type">${event.type}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
                
                return html;
            }
        }

        // Û·. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ
        class OnChainAnalysis {
            static async getOnChainData(coinSymbol) {
                try {
                    // Ø¨Ø±Ø§ÛŒ Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†
                    if (coinSymbol.toLowerCase() === 'btc') {
                        const response = await fetch('https://blockchain.info/q/');
                        const data = await response.json();
                        
                        return {
                            activeAddresses: {
                                current: 850000,
                                change24h: 2.5,
                                trend: 'up'
                            },
                            exchangeFlows: {
                                inflow: 1250,
                                outflow: 1800,
                                netFlow: -550,
                                sentiment: 'positive'
                            },
                            hashRate: {
                                current: data.hashrate || 450,
                                change24h: 1.2,
                                trend: 'up'
                            }
                        };
                    }
                    
                    // Ø¨Ø±Ø§ÛŒ Ø³Ø§ÛŒØ± Ø§Ø±Ø²Ù‡Ø§ - Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
                    return {
                        activeAddresses: {
                            current: 50000,
                            change24h: 1.5,
                            trend: 'up'
                        },
                        exchangeFlows: {
                            inflow: 450,
                            outflow: 600,
                            netFlow: -150,
                            sentiment: 'positive'
                        },
                        hashRate: {
                            current: 150,
                            change24h: 0.8,
                            trend: 'up'
                        }
                    };
                } catch (error) {
                    console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ:', error);
                    return null;
                }
            }
            
            static renderOnChainData(data) {
                if (!data) {
                    return '<p>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ Ø¯Ø± Ø¯Ø³ØªØ±Ø³ Ù†ÛŒØ³Øª.</p>';
                }
                
                let html = '<div class="onchain-metrics">';
                
                // Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
                const addrTrendIcon = data.activeAddresses.trend === 'up' ? 'â†—' : 'â†˜';
                const addrTrendClass = data.activeAddresses.trend === 'up' ? 'positive' : 'negative';
                html += `
                    <div class="onchain-metric">
                        <div class="metric-label">Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</div>
                        <div class="metric-value">${(data.activeAddresses.current / 1000).toFixed(1)}K</div>
                        <div class="metric-change ${addrTrendClass}">
                            ${addrTrendIcon} ${data.activeAddresses.change24h}%
                        </div>
                    </div>
                `;
                
                // Ø¬Ø±ÛŒØ§Ù† ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§
                const flowSentiment = data.exchangeFlows.netFlow > 0 ? 'Ù…Ù†ÙÛŒ' : 'Ù…Ø«Ø¨Øª';
                const flowClass = data.exchangeFlows.netFlow > 0 ? 'negative' : 'positive';
                html += `
                    <div class="onchain-metric">
                        <div class="metric-label">Ø¬Ø±ÛŒØ§Ù† ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§</div>
                        <div class="metric-value">${Math.abs(data.exchangeFlows.netFlow).toFixed(0)}</div>
                        <div class="metric-change ${flowClass}">
                            ${flowSentiment} (${data.exchangeFlows.netFlow > 0 ? 'ÙˆØ±ÙˆØ¯' : 'Ø®Ø±ÙˆØ¬'} Ø®Ø§Ù„Øµ)
                        </div>
                    </div>
                `;
                
                // Ù‡Ø´ Ø±ÛŒØª
                const hashTrendIcon = data.hashRate.trend === 'up' ? 'â†—' : 'â†˜';
                const hashTrendClass = data.hashRate.trend === 'up' ? 'positive' : 'negative';
                html += `
                    <div class="onchain-metric">
                        <div class="metric-label">Ù‡Ø´ Ø±ÛŒØª</div>
                        <div class="metric-value">${data.hashRate.current.toFixed(0)}</div>
                        <div class="metric-change ${hashTrendClass}">
                            ${hashTrendIcon} ${data.hashRate.change24h}%
                        </div>
                    </div>
                `;
                
                html += '</div>';
                
                // ØªØ­Ù„ÛŒÙ„
                html += '<div class="analysis-box" style="margin-top: 15px;">';
                if (data.exchangeFlows.netFlow < -500) {
                    html += '<div class="alert-success">Ø®Ø±ÙˆØ¬ Ø®Ø§Ù„Øµ Ø§Ø² ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§ - Ù†Ø´Ø§Ù†Ù‡ Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ</div>';
                } else if (data.exchangeFlows.netFlow > 500) {
                    html += '<div class="alert-danger">ÙˆØ±ÙˆØ¯ Ø®Ø§Ù„Øµ Ø¨Ù‡ ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§ - Ø§Ø­ØªÙ…Ø§Ù„ ÙØ±ÙˆØ´</div>';
                }
                
                if (data.activeAddresses.trend === 'up') {
                    html += '<div class="alert-success">Ø±Ø´Ø¯ Ø¢Ø¯Ø±Ø³â€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ - Ù†Ø´Ø§Ù†Ù‡ Ù¾Ø°ÛŒØ±Ø´ Ø¨ÛŒØ´ØªØ±</div>';
                }
                
                html += '</div>';
                
                return html;
            }
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² ØªÚ©ÛŒ ====================
        async function analyzeSingleCoin(coinId, renderIndividual = true) {
            try {
                StatusManager.show(`Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²...`, 'info');
                
                const details = await APIManager.getCoinDetails(coinId);
                
                if (!details || !details.market_data) {
                    throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø² Ø¯Ø±ÛŒØ§ÙØª Ù†Ø´Ø¯');
                }
                
                const ohlcData = await APIManager.getCoinOHLC(coinId, 30);
                
                if (!ohlcData || !Array.isArray(ohlcData) || ohlcData.length < 20) {
                    throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ØªØ§Ø±ÛŒØ®ÛŒ Ù†Ø§Ú©Ø§ÙÛŒ');
                }
                
                const closes = ohlcData.map(c => c[4] || 0).filter(c => c > 0);
                const highs = ohlcData.map(c => c[2] || 0);
                const lows = ohlcData.map(c => c[3] || 0);
                
                if (closes.length < 20) {
                    throw new Error('Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚ÛŒÙ…Øª Ù†Ø§Ú©Ø§ÙÛŒ');
                }
                
                const price = details.market_data.current_price.usd || closes[closes.length-1] || 0;
                const change24h = details.market_data.price_change_percentage_24h || 0;
                
                const ema9 = TechnicalAnalysis.calculateEMA(closes, 9);
                const ema20 = TechnicalAnalysis.calculateEMA(closes, 20);
                const ema50 = TechnicalAnalysis.calculateEMA(closes, 50);
                const rsi = TechnicalAnalysis.calculateRSI(closes);
                const atr = TechnicalAnalysis.calculateATR(highs, lows, closes);
                const macd = TechnicalAnalysis.calculateMACD(closes);
                const bb = TechnicalAnalysis.calculateBollingerBands(closes);
                const stoch = TechnicalAnalysis.calculateStochastic(highs, lows, closes);
                
                const analyses = {
                    rsi: PersianAnalysis.getRSIAnalysis(rsi),
                    macd: PersianAnalysis.getMACDAnalysis(macd),
                    trend: PersianAnalysis.getTrendAnalysis(ema9, ema20, ema50, price),
                    volatility: PersianAnalysis.getVolatilityAnalysis(atr, price),
                    bollinger: PersianAnalysis.getBollingerAnalysis(price, bb),
                    stochastic: PersianAnalysis.getStochasticAnalysis(stoch)
                };
                
                const scoreData = { rsi, ema9, ema20, ema50, macd, atr, price, stoch, bb };
                const score = ScoringSystem.calculateScore(scoreData);
                const signal = ScoringSystem.getSignal(score);
                const swingStatus = ScoringSystem.getSwingStatus(scoreData);
                const confidence = Math.round(score * 0.9);
                
                const result = {
                    id: details.id,
                    name: details.name,
                    symbol: details.symbol.toUpperCase(),
                    price,
                    change24h,
                    marketCap: details.market_data.market_cap.usd || 0,
                    volume: details.market_data.total_volume.usd || 0,
                    marketCapRank: details.market_cap_rank || 100,
                    indicators: { ema9, ema20, ema50, rsi, atr, macd, bb, stoch },
                    analyses,
                    score,
                    confidence,
                    signal: signal.signal,
                    signalClass: signal.class,
                    swingStatus: swingStatus.status,
                    swingColor: swingStatus.color === 'green' ? 'var(--green)' : swingStatus.color === 'yellow' ? 'var(--yellow)' : 'var(--red)',
                    closes,
                    highs,
                    lows,
                    error: false
                };
                
                if (renderIndividual) {
                    renderSingleCoin(result);
                }
                
                return result;
            } catch (error) {
                console.error(`Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²:`, error);
                return {
                    error: true,
                    message: error.message
                };
            }
        }

        // ==================== Ø±Ù†Ø¯Ø± Ø§Ø±Ø² ØªÚ©ÛŒ ====================
        function renderSingleCoin(data) {
            if (currentCharts.length > 0) {
                currentCharts.forEach(chart => chart.destroy());
                currentCharts = [];
            }
            
            document.getElementById('single-coin-section').style.display = 'block';
            document.getElementById('coins-section-10').style.display = 'none';
            document.getElementById('coins-section-40').style.display = 'none';
            document.getElementById('advanced-analysis-section').style.display = 'none';
            document.getElementById('output').style.display = 'none';
            
            const singleCoinContent = document.getElementById('single-coin-content');
            const singleCoinSubtitle = document.getElementById('single-coin-subtitle');
            
            singleCoinSubtitle.textContent = `ØªØ­Ù„ÛŒÙ„ ${data.name} (${data.symbol}) - ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ Ùˆ Ø¨Ù†ÛŒØ§Ø¯ÛŒ Ø¨Ø§ Ø¬Ø²Ø¦ÛŒØ§Øª Ú©Ø§Ù…Ù„`;
            currentCoinId = data.id;
            
            if (data.error) {
                singleCoinContent.innerHTML = `
                    <div class="alert-danger">
                        <h3>Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ ${data.name}</h3>
                        <p>${data.message || "Ø®Ø·Ø§ÛŒ Ù†Ø§Ù…Ø´Ø®Øµ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø§ÛŒÙ† Ø§Ø±Ø² Ø±Ø® Ø¯Ø§Ø¯."}</p>
                        <button class="action-btn" onclick="searchAndAnalyze('${data.id}')" style="margin-top:10px">
                            <i class="fas fa-redo"></i> ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
                        </button>
                    </div>`;
                return;
            }
            
            singleCoinContent.innerHTML = `
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px">
                    <div>
                        <h2>${data.name} (${data.symbol})</h2>
                        <span class="badge ${data.signalClass}">Ø³ÛŒÚ¯Ù†Ø§Ù„: ${data.signal}</span>
                    </div>
                    <div style="text-align:right">
                        <h1>${Helpers.formatPrice(data.price)}</h1>
                        <p class="conf">Ø§Ø¹ØªÙ…Ø§Ø¯: ${data.confidence}%</p>
                        <p>ÙˆØ¶Ø¹ÛŒØª Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ: <span style="color:${data.swingColor};font-weight:bold">${data.swingStatus}</span></p>
                    </div>
                </div>
                
                <div class="progress-bar">
                    <div class="progress-fill" style="width:${data.score}%;background:${data.signalClass==='buy'?'var(--green)':data.signalClass==='sell'?'var(--red)':'var(--yellow)'}"></div>
                </div>
                
                <div class="coin-stats-grid">
                    <div class="stat-item">
                        <div class="stat-label">ØªØºÛŒÛŒØ± 24h</div>
                        <div class="stat-value" style="color:${Helpers.getChangeColor(data.change24h)}">
                            ${data.change24h >= 0 ? '+' : ''}${Helpers.formatNumber(data.change24h, 2)}%
                        </div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Ø§Ø±Ø²Ø´ Ø¨Ø§Ø²Ø§Ø±</div>
                        <div class="stat-value">$${Helpers.formatNumber(data.marketCap / 1000000, 1)}M</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
                        <div class="stat-value">$${Helpers.formatNumber(data.volume / 1000000, 1)}M</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">Ø±ØªØ¨Ù‡ Ø¨Ø§Ø²Ø§Ø±</div>
                        <div class="stat-value">#${data.marketCapRank}</div>
                    </div>
                </div>
                
                <div class="analysis-box">
                    <h3><i class="fas fa-chart-bar"></i> ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„</h3>
                    <ul>
                        <li>${data.analyses.rsi}</li>
                        <li>${data.analyses.macd}</li>
                        <li>${data.analyses.trend}</li>
                        <li>${data.analyses.volatility}</li>
                        <li>${data.analyses.bollinger}</li>
                        <li>${data.analyses.stochastic}</li>
                    </ul>
                </div>
                
                <div class="chart-container"><canvas id="single-coin-chart"></canvas></div>
                
                <div style="margin-top:20px; text-align:center;">
                    <button class="action-btn" onclick="showAdvancedAnalysis()" style="padding:12px 24px; font-size:14px; background: var(--purple);">
                        <i class="fas fa-chart-line"></i> Ù…Ø´Ø§Ù‡Ø¯Ù‡ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ (Û· ÙˆÛŒÚ˜Ú¯ÛŒ Ø¬Ø¯ÛŒØ¯)
                    </button>
                </div>`;
            
            const ctx = document.getElementById('single-coin-chart').getContext('2d');
            const chartData = data.closes && data.closes.length > 10 ? data.closes : Array.from({length:30}, (_,i)=>data.price*(0.9+0.2*(i/30)));
            
            const chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: Array.from({length:chartData.length}, (_,i)=>i+1),
                    datasets: [{
                        label: 'Ù‚ÛŒÙ…Øª (USD)',
                        data: chartData,
                        borderColor: data.signalClass==='buy'?'#00c896':data.signalClass==='sell'?'#ff6b6b':'#ffd166',
                        backgroundColor: `rgba(${data.signalClass==='buy'?'0,200,150':data.signalClass==='sell'?'255,107,107':'255,209,102'},0.1)`,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {legend: {display: false}},
                    scales: {
                        y: {beginAtZero: false, grid: {color: 'rgba(255,255,255,0.1)'}},
                        x: {grid: {color: 'rgba(255,255,255,0.1)'}}
                    }
                }
            });
            
            currentCharts.push(chart);
            StatusManager.show(`ØªØ­Ù„ÛŒÙ„ ${data.name} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯`, 'success');
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ ====================
        async function showAdvancedAnalysis() {
            if (!currentCoinId) return;
            
            // Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ø¨Ø®Ø´â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒÚ¯Ø±
            document.getElementById('single-coin-section').style.display = 'none';
            document.getElementById('coins-section-10').style.display = 'none';
            document.getElementById('coins-section-40').style.display = 'none';
            document.getElementById('output').style.display = 'none';
            
            // Ù†Ù…Ø§ÛŒØ´ Ø¨Ø®Ø´ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡
            document.getElementById('advanced-analysis-section').style.display = 'block';
            
            StatusManager.show('Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡...', 'info');
            
            // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ø±Ø²
            const result = await analyzeSingleCoin(currentCoinId, false);
            
            if (result.error) {
                StatusManager.show('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡', 'error');
                return;
            }
            
            // Û±. Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ
            const fibHigh = Math.max(...result.highs.slice(-30));
            const fibLow = Math.min(...result.lows.slice(-30));
            document.getElementById('fibonacci-content').innerHTML = FibonacciAnalysis.renderFibonacci(result.price, fibHigh, fibLow);
            
            // Û². Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ
            const patterns = PatternRecognition.detectPatterns(result.closes);
            document.getElementById('patterns-content').innerHTML = PatternRecognition.renderPatterns(patterns);
            
            // Û³. ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… - Ú©Ø§Ù…Ù„Ø§Ù‹ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
            const volumeHtml = await VolumeAnalysis.analyzeVolume(result.id);
            document.getElementById('volume-content').innerHTML = volumeHtml;
            
            // Û´. Ø³Ø·ÙˆØ­ Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª
            const srLevels = SupportResistance.identifyLevels(result.closes);
            document.getElementById('sr-content').innerHTML = SupportResistance.renderLevels(result.price, srLevels.supports, srLevels.resistances);
            
            // Ûµ. Ø§Ø®Ø¨Ø§Ø±
            const news = await NewsIntegration.getNews(result.name);
            document.getElementById('news-content').innerHTML = NewsIntegration.renderNews(news);
            
            // Û¶. Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§
            const events = await EventsCalendar.getEvents(result.id);
            document.getElementById('events-content').innerHTML = EventsCalendar.renderEvents(events);
            
            // Û·. Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ
            const onChainData = await OnChainAnalysis.getOnChainData(result.symbol);
            document.getElementById('onchain-content').innerHTML = OnChainAnalysis.renderOnChainData(onChainData);
            
            // ØªÙ†Ø¸ÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ ØªØ¨â€ŒÙ‡Ø§
            setupAdvancedTabs();
            
            StatusManager.show('ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø´Ø¯Ù†Ø¯', 'success');
        }

        // ==================== ØªÙ†Ø¸ÛŒÙ… ØªØ¨â€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ ====================
        function setupAdvancedTabs() {
            const tabBtns = document.querySelectorAll('#advanced-analysis-section .tab-btn');
            const tabContents = document.querySelectorAll('#advanced-analysis-section .advanced-tab-content');
            
            tabBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    const tabId = btn.getAttribute('data-tab');
                    
                    // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªØ¨â€ŒÙ‡Ø§
                    tabBtns.forEach(b => b.classList.remove('active'));
                    tabContents.forEach(c => c.classList.remove('active'));
                    
                    // ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† ØªØ¨ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
                    btn.classList.add('active');
                    document.getElementById(tabId).classList.add('active');
                });
            });
        }

        // ==================== Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØªØ­Ù„ÛŒÙ„ ØªÚ©ÛŒ ====================
        function backToSingleCoin() {
            document.getElementById('advanced-analysis-section').style.display = 'none';
            document.getElementById('single-coin-section').style.display = 'block';
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ± ====================
        async function analyzeTop10Coins() {
            const startTime = Date.now();
            const button = document.getElementById('analyze-top10-btn');
            const originalText = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„...';
            button.disabled = true;
            
            StatusManager.show('Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø±...', 'info');
            
            try {
                document.getElementById('output').innerHTML = `
                    <div class="card">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø± Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª...
                            <div class="progress-bar" style="margin-top:20px">
                                <div class="progress-fill" id="analysis-progress-10" style="width:10%;background:var(--blue)"></div>
                            </div>
                            <p style="margin-top:15px;color:var(--muted)">Ø§ÛŒÙ† ÙØ±Ø¢ÛŒÙ†Ø¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªØ§ 15 Ø«Ø§Ù†ÛŒÙ‡ Ø·ÙˆÙ„ Ø¨Ú©Ø´Ø¯</p>
                        </div>
                    </div>`;
                
                const coins = await APIManager.getTopCoins(CONFIG.TOP_COINS_COUNT_10);
                
                if (!coins || coins.length === 0) {
                    throw new Error('Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯');
                }
                
                allCoinsData10 = [];
                const batchSize = 3;
                
                for (let i = 0; i < coins.length; i += batchSize) {
                    const batch = coins.slice(i, i + batchSize);
                    
                    const progress = ((i + batchSize) / coins.length) * 90 + 10;
                    document.getElementById('analysis-progress-10').style.width = `${Math.min(progress, 100)}%`;
                    
                    StatusManager.show(`ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²Ù‡Ø§ÛŒ ${i + 1} ØªØ§ ${Math.min(i + batchSize, coins.length)}...`, 'info');
                    
                    const batchPromises = batch.map(coin => analyzeSingleCoin(coin.id, false));
                    const batchResults = await Promise.all(batchPromises);
                    
                    batchResults.forEach((result, index) => {
                        if (!result.error) {
                            allCoinsData10.push({
                                ...result,
                                marketCapRank: coins[i + index]?.market_cap_rank || 100
                            });
                        }
                    });
                    
                    if (i + batchSize < coins.length) {
                        await Helpers.sleep(800);
                    }
                }
                
                renderCoinsTable10();
                document.getElementById('coins-section-10').style.display = 'block';
                document.getElementById('coins-section-40').style.display = 'none';
                document.getElementById('single-coin-section').style.display = 'none';
                document.getElementById('advanced-analysis-section').style.display = 'none';
                document.getElementById('output').style.display = 'none';
                
                const endTime = Date.now();
                const duration = ((endTime - startTime) / 1000).toFixed(1);
                
                StatusManager.show(`ØªØ­Ù„ÛŒÙ„ ${allCoinsData10.length} Ø§Ø±Ø² Ø¯Ø± ${duration} Ø«Ø§Ù†ÛŒÙ‡ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯`, 'success');
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²Ù‡Ø§:', error);
                
                document.getElementById('output').innerHTML = `
                    <div class="card">
                        <div class="alert-danger">
                            <h3><i class="fas fa-exclamation-circle"></i> Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±</h3>
                            <p>${error.message}</p>
                            <button class="action-btn" onclick="analyzeTop10Coins()" style="margin-top:15px;padding:12px 24px">
                                <i class="fas fa-redo"></i> ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
                            </button>
                        </div>
                    </div>`;
                
                StatusManager.show(`Ø®Ø·Ø§: ${error.message}`, 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // ==================== ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± - Ú©Ø§Ù…Ù„Ø§Ù‹ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ ====================
        async function analyzeTop40Coins() {
            const startTime = Date.now();
            const button = document.getElementById('analyze-top40-btn');
            const originalText = button.innerHTML;
            
            button.innerHTML = '<i class="fas fa-spinner loading-spinner"></i> Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„...';
            button.disabled = true;
            
            StatusManager.show('Ø´Ø±ÙˆØ¹ ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø±...', 'info');
            
            try {
                document.getElementById('output').innerHTML = `
                    <div class="card">
                        <div class="loading">
                            <i class="fas fa-spinner loading-spinner"></i> ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ± Ø¨Ø§Ø²Ø§Ø± Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†Ø¬Ø§Ù… Ø§Ø³Øª...
                            <div class="progress-bar" style="margin-top:20px">
                                <div class="progress-fill" id="analysis-progress-40" style="width:10%;background:var(--blue)"></div>
                            </div>
                            <p style="margin-top:15px;color:var(--muted)">Ø§ÛŒÙ† ÙØ±Ø¢ÛŒÙ†Ø¯ Ù…Ù…Ú©Ù† Ø§Ø³Øª ØªØ§ 45 Ø«Ø§Ù†ÛŒÙ‡ Ø·ÙˆÙ„ Ø¨Ú©Ø´Ø¯</p>
                        </div>
                    </div>`;
                
                const coins = await APIManager.getTopCoins(CONFIG.TOP_COINS_COUNT_40);
                
                if (!coins || coins.length === 0) {
                    throw new Error('Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ ÛŒØ§ÙØª Ù†Ø´Ø¯');
                }
                
                allCoinsData40 = [];
                const batchSize = 5; // Ø§ÙØ²Ø§ÛŒØ´ batch size Ø¨Ø±Ø§ÛŒ Ø³Ø±Ø¹Øª Ø¨ÛŒØ´ØªØ±
                
                for (let i = 0; i < coins.length; i += batchSize) {
                    const batch = coins.slice(i, i + batchSize);
                    
                    const progress = ((i + batchSize) / coins.length) * 90 + 10;
                    document.getElementById('analysis-progress-40').style.width = `${Math.min(progress, 100)}%`;
                    
                    StatusManager.show(`ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²Ù‡Ø§ÛŒ ${i + 1} ØªØ§ ${Math.min(i + batchSize, coins.length)}...`, 'info');
                    
                    const batchPromises = batch.map(coin => {
                        return new Promise(async (resolve) => {
                            try {
                                const result = await analyzeSingleCoin(coin.id, false);
                                resolve({ success: true, data: result });
                            } catch (error) {
                                console.warn(`Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ ${coin.id}:`, error);
                                resolve({ success: false, data: { error: true, name: coin.name, symbol: coin.symbol, id: coin.id } });
                            }
                        });
                    });
                    
                    const batchResults = await Promise.all(batchPromises);
                    
                    batchResults.forEach((result) => {
                        if (result.success && !result.data.error) {
                            allCoinsData40.push(result.data);
                        } else if (!result.success) {
                            allCoinsData40.push({
                                ...result.data,
                                error: true
                            });
                        }
                    });
                    
                    if (i + batchSize < coins.length) {
                        await Helpers.sleep(1500); // Ø§ÙØ²Ø§ÛŒØ´ Ø²Ù…Ø§Ù† Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù…Ø­Ø¯ÙˆØ¯ÛŒØª API
                    }
                }
                
                renderCoinsTable40();
                document.getElementById('coins-section-40').style.display = 'block';
                document.getElementById('coins-section-10').style.display = 'none';
                document.getElementById('single-coin-section').style.display = 'none';
                document.getElementById('advanced-analysis-section').style.display = 'none';
                document.getElementById('output').style.display = 'none';
                
                const endTime = Date.now();
                const duration = ((endTime - startTime) / 1000).toFixed(1);
                
                StatusManager.show(`ØªØ­Ù„ÛŒÙ„ ${allCoinsData40.filter(c => !c.error).length} Ø§Ø² ${coins.length} Ø§Ø±Ø² Ø¯Ø± ${duration} Ø«Ø§Ù†ÛŒÙ‡ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯`, 'success');
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²Ù‡Ø§:', error);
                
                document.getElementById('output').innerHTML = `
                    <div class="card">
                        <div class="alert-danger">
                            <h3><i class="fas fa-exclamation-circle"></i> Ø®Ø·Ø§ Ø¯Ø± ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±</h3>
                            <p>${error.message}</p>
                            <button class="action-btn" onclick="analyzeTop40Coins()" style="margin-top:15px;padding:12px 24px">
                                <i class="fas fa-redo"></i> ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯
                            </button>
                        </div>
                    </div>`;
                
                StatusManager.show(`Ø®Ø·Ø§: ${error.message}`, 'error');
            } finally {
                button.innerHTML = originalText;
                button.disabled = false;
            }
        }

        // ==================== Ø±Ù†Ø¯Ø± Ø¬Ø¯ÙˆÙ„ 10 Ø§Ø±Ø² ====================
        function renderCoinsTable10() {
            const tableBody = document.getElementById('all-coins-list-10');
            
            if (!allCoinsData10 || allCoinsData10.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align:center;padding:40px">
                            <div class="alert-warning">
                                <i class="fas fa-info-circle"></i>
                                Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙÙ‚ ÛŒØ§ÙØª Ù†Ø´Ø¯.
                            </div>
                        </td>
                    </tr>`;
                return;
            }
            
            let html = '';
            let successfulCount = 0;
            let buyCount = 0, sellCount = 0, holdCount = 0, waitCount = 0;
            let totalScore = 0;
            
            allCoinsData10.forEach((coin, index) => {
                if (coin.error) {
                    html += `
                        <tr class="coin-row">
                            <td>${index + 1}</td>
                            <td><strong>${coin.name}</strong><br><small>${coin.symbol}</small></td>
                            <td>${Helpers.formatPrice(coin.price || 0)}</td>
                            <td style="color:var(--muted)">N/A</td>
                            <td><span class="badge wait" style="opacity:0.7">Ø®Ø·Ø§</span></td>
                            <td>0%</td>
                            <td><span style="color:var(--muted)">Ù†Ø§Ù…Ø´Ø®Øµ</span></td>
                            <td><span style="color:var(--muted)">N/A</span></td>
                            <td><button class="action-btn" onclick="searchAndAnalyze('${coin.id}')" style="opacity:0.7">ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯</button></td>
                        </tr>`;
                } else {
                    successfulCount++;
                    const changeColor = Helpers.getChangeColor(coin.change24h);
                    const rsiColor = Helpers.getColorByValue(coin.indicators.rsi, false);
                    
                    if (coin.signal === "Ø®Ø±ÛŒØ¯") buyCount++;
                    else if (coin.signal === "ÙØ±ÙˆØ´") sellCount++;
                    else if (coin.signal === "Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ") holdCount++;
                    else if (coin.signal === "ØµØ¨Ø±") waitCount++;
                    
                    totalScore += coin.score || 0;
                    
                    html += `
                        <tr class="coin-row" onclick="searchAndAnalyze('${coin.id}')" style="cursor:pointer">
                            <td>${index + 1}</td>
                            <td>
                                <strong>${coin.name}</strong><br>
                                <small>${coin.symbol}</small>
                                ${coin.marketCapRank <= 10 ? ' <span class="real-time-badge">TOP 10</span>' : ''}
                            </td>
                            <td>
                                <div style="font-weight:bold">${Helpers.formatPrice(coin.price)}</div>
                                <small style="color:var(--muted)">Ø§Ø±Ø²Ø´ Ø¨Ø§Ø²Ø§Ø±: $${Helpers.formatNumber(coin.marketCap / 1000000, 1)}M</small>
                            </td>
                            <td>
                                <div class="price-change-indicator ${coin.change24h >= 0 ? 'change-up' : 'change-down'}">
                                    ${coin.change24h >= 0 ? 'â†—' : 'â†˜'} ${Helpers.formatNumber(coin.change24h, 2)}%
                                </div>
                            </td>
                            <td><span class="badge ${coin.signalClass}">${coin.signal}</span></td>
                            <td>
                                <div style="font-weight:bold">${Math.round(coin.confidence)}%</div>
                                <div class="progress-bar" style="height:4px;margin-top:5px">
                                    <div class="progress-fill" style="width:${coin.confidence}%;background:${Helpers.getColorByValue(coin.confidence)}"></div>
                                </div>
                            </td>
                            <td>
                                <span style="color:${coin.swingColor};font-weight:bold">${coin.swingStatus}</span><br>
                                <small style="color:var(--muted)">${coin.score ? coin.score.toFixed(1) : 'N/A'} Ø§Ù…ØªÛŒØ§Ø²</small>
                            </td>
                            <td>
                                <span style="color:${rsiColor};font-weight:bold">
                                    ${coin.indicators.rsi.toFixed(1)}
                                </span>
                            </td>
                            <td>
                                <button class="detail-view-btn" onclick="event.stopPropagation();searchAndAnalyze('${coin.id}')">
                                    <i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ Ø¬Ø²Ø¦ÛŒØ§Øª
                                </button>
                            </td>
                        </tr>`;
                }
            });
            
            tableBody.innerHTML = html;
            
            const time = Helpers.getCurrentTime();
            document.getElementById('last-update-time-10').innerHTML = 
                `Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ${time.time}`;
            
            const avgScore = successfulCount > 0 ? totalScore / successfulCount : 0;
            let marketSentiment = "Ø®Ù†Ø«ÛŒ";
            let sentimentClass = "neutral";
            if (buyCount > sellCount * 1.5 && avgScore > 55) {
                marketSentiment = "ØµØ¹ÙˆØ¯ÛŒ";
                sentimentClass = "good";
            } else if (sellCount > buyCount * 1.5 && avgScore < 45) {
                marketSentiment = "Ù†Ø²ÙˆÙ„ÛŒ";
                sentimentClass = "bad";
            }
            
            const summaryText = `
                ØªØ­Ù„ÛŒÙ„ <strong>${allCoinsData10.length} Ø§Ø±Ø²</strong> Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ 
                (<strong>${successfulCount} Ù…ÙˆÙÙ‚</strong>) |
                <strong>ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²Ø§Ø±:</strong> <span class="${sentimentClass}">${marketSentiment}</span> |
                <strong>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²:</strong> ${avgScore.toFixed(1)}<br>
                <strong>ØªÙˆØ²ÛŒØ¹ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§:</strong> 
                <span class="good">${buyCount} Ø®Ø±ÛŒØ¯</span> | 
                <span class="bad">${sellCount} ÙØ±ÙˆØ´</span> | 
                <span class="neutral">${holdCount + waitCount} Ø®Ù†Ø«ÛŒ</span>
            `;
            
            document.getElementById('summary-text-10').innerHTML = summaryText;
        }

        // ==================== Ø±Ù†Ø¯Ø± Ø¬Ø¯ÙˆÙ„ 40 Ø§Ø±Ø² ====================
        function renderCoinsTable40() {
            const tableBody = document.getElementById('all-coins-list-40');
            
            if (!allCoinsData40 || allCoinsData40.length === 0) {
                tableBody.innerHTML = `
                    <tr>
                        <td colspan="9" style="text-align:center;padding:40px">
                            <div class="alert-warning">
                                <i class="fas fa-info-circle"></i>
                                Ù‡ÛŒÚ† Ø§Ø±Ø²ÛŒ Ø¨Ø§ ØªØ­Ù„ÛŒÙ„ Ù…ÙˆÙÙ‚ ÛŒØ§ÙØª Ù†Ø´Ø¯.
                            </div>
                        </td>
                    </tr>`;
                return;
            }
            
            let html = '';
            let successfulCount = 0;
            let buyCount = 0, sellCount = 0, holdCount = 0, waitCount = 0;
            let totalScore = 0;
            
            allCoinsData40.forEach((coin, index) => {
                if (coin.error) {
                    html += `
                        <tr class="coin-row">
                            <td>${index + 1}</td>
                            <td><strong>${coin.name}</strong><br><small>${coin.symbol}</small></td>
                            <td>${Helpers.formatPrice(coin.price || 0)}</td>
                            <td style="color:var(--muted)">N/A</td>
                            <td><span class="badge wait" style="opacity:0.7">Ø®Ø·Ø§</span></td>
                            <td>0%</td>
                            <td><span style="color:var(--muted)">Ù†Ø§Ù…Ø´Ø®Øµ</span></td>
                            <td><span style="color:var(--muted)">N/A</span></td>
                            <td><button class="action-btn" onclick="searchAndAnalyze('${coin.id}')" style="opacity:0.7">ØªÙ„Ø§Ø´ Ù…Ø¬Ø¯Ø¯</button></td>
                        </tr>`;
                } else {
                    successfulCount++;
                    const changeColor = Helpers.getChangeColor(coin.change24h);
                    const rsiColor = Helpers.getColorByValue(coin.indicators.rsi, false);
                    
                    if (coin.signal === "Ø®Ø±ÛŒØ¯") buyCount++;
                    else if (coin.signal === "ÙØ±ÙˆØ´") sellCount++;
                    else if (coin.signal === "Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ") holdCount++;
                    else if (coin.signal === "ØµØ¨Ø±") waitCount++;
                    
                    totalScore += coin.score || 0;
                    
                    html += `
                        <tr class="coin-row" onclick="searchAndAnalyze('${coin.id}')" style="cursor:pointer">
                            <td>${index + 1}</td>
                            <td>
                                <strong>${coin.name}</strong><br>
                                <small>${coin.symbol}</small>
                                ${coin.marketCapRank <= 10 ? ' <span class="real-time-badge">TOP 10</span>' : 
                                 coin.marketCapRank <= 20 ? ' <span class="real-time-badge" style="background:rgba(255,209,102,.2);color:var(--yellow)">TOP 20</span>' : 
                                 coin.marketCapRank <= 40 ? ' <span class="real-time-badge" style="background:rgba(155,155,255,.2);color:#9b9bff">TOP 40</span>' : ''}
                            </td>
                            <td>
                                <div style="font-weight:bold">${Helpers.formatPrice(coin.price)}</div>
                                <small style="color:var(--muted)">Ø§Ø±Ø²Ø´ Ø¨Ø§Ø²Ø§Ø±: $${Helpers.formatNumber(coin.marketCap / 1000000, 1)}M</small>
                            </td>
                            <td>
                                <div class="price-change-indicator ${coin.change24h >= 0 ? 'change-up' : 'change-down'}">
                                    ${coin.change24h >= 0 ? 'â†—' : 'â†˜'} ${Helpers.formatNumber(coin.change24h, 2)}%
                                </div>
                            </td>
                            <td><span class="badge ${coin.signalClass}">${coin.signal}</span></td>
                            <td>
                                <div style="font-weight:bold">${Math.round(coin.confidence)}%</div>
                                <div class="progress-bar" style="height:4px;margin-top:5px">
                                    <div class="progress-fill" style="width:${coin.confidence}%;background:${Helpers.getColorByValue(coin.confidence)}"></div>
                                </div>
                            </td>
                            <td>
                                <span style="color:${coin.swingColor};font-weight:bold">${coin.swingStatus}</span><br>
                                <small style="color:var(--muted)">${coin.score ? coin.score.toFixed(1) : 'N/A'} Ø§Ù…ØªÛŒØ§Ø²</small>
                            </td>
                            <td>
                                <span style="color:${rsiColor};font-weight:bold">
                                    ${coin.indicators.rsi.toFixed(1)}
                                </span>
                            </td>
                            <td>
                                <button class="detail-view-btn" onclick="event.stopPropagation();searchAndAnalyze('${coin.id}')">
                                    <i class="fas fa-chart-line"></i> ØªØ­Ù„ÛŒÙ„ Ø¬Ø²Ø¦ÛŒØ§Øª
                                </button>
                            </td>
                        </tr>`;
                }
            });
            
            tableBody.innerHTML = html;
            
            const time = Helpers.getCurrentTime();
            document.getElementById('last-update-time-40').innerHTML = 
                `Ø¢Ø®Ø±ÛŒÙ† Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: ${time.time}`;
            
            const avgScore = successfulCount > 0 ? totalScore / successfulCount : 0;
            let marketSentiment = "Ø®Ù†Ø«ÛŒ";
            let sentimentClass = "neutral";
            if (buyCount > sellCount * 1.5 && avgScore > 55) {
                marketSentiment = "ØµØ¹ÙˆØ¯ÛŒ";
                sentimentClass = "good";
            } else if (sellCount > buyCount * 1.5 && avgScore < 45) {
                marketSentiment = "Ù†Ø²ÙˆÙ„ÛŒ";
                sentimentClass = "bad";
            }
            
            const summaryText = `
                ØªØ­Ù„ÛŒÙ„ <strong>${allCoinsData40.length} Ø§Ø±Ø²</strong> Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯ 
                (<strong>${successfulCount} Ù…ÙˆÙÙ‚</strong>) |
                <strong>ÙˆØ¶Ø¹ÛŒØª Ø¨Ø§Ø²Ø§Ø±:</strong> <span class="${sentimentClass}">${marketSentiment}</span> |
                <strong>Ù…ÛŒØ§Ù†Ú¯ÛŒÙ† Ø§Ù…ØªÛŒØ§Ø²:</strong> ${avgScore.toFixed(1)}<br>
                <strong>ØªÙˆØ²ÛŒØ¹ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§:</strong> 
                <span class="good">${buyCount} Ø®Ø±ÛŒØ¯</span> | 
                <span class="bad">${sellCount} ÙØ±ÙˆØ´</span> | 
                <span class="neutral">${holdCount + waitCount} Ø®Ù†Ø«ÛŒ</span>
            `;
            
            document.getElementById('summary-text-40').innerHTML = summaryText;
        }

        // ==================== Ø¬Ø³ØªØ¬Ùˆ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² ====================
        async function searchAndAnalyze(coinId) {
            if (!coinId) {
                const searchInput = document.getElementById('search').value.trim();
                if (searchInput.length < 2) {
                    StatusManager.show('Ù„Ø·ÙØ§ Ù†Ø§Ù… ÛŒØ§ Ù†Ù…Ø§Ø¯ Ø§Ø±Ø² Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯', 'warning');
                    return;
                }
                
                // Ø¬Ø³ØªØ¬ÙˆÛŒ Ø§Ø±Ø²
                const results = await APIManager.searchCoins(searchInput);
                if (results && results.length > 0) {
                    coinId = results[0].id;
                } else {
                    StatusManager.show('Ø§Ø±Ø² Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯', 'error');
                    return;
                }
            }
            
            StatusManager.show('Ø¯Ø± Ø­Ø§Ù„ Ø¬Ø³ØªØ¬Ùˆ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²...', 'info');
            await analyzeSingleCoin(coinId, true);
        }

        // ==================== ØªÙ†Ø¸ÛŒÙ… Ø¬Ø³ØªØ¬Ùˆ ====================
        function setupSearch() {
            const searchInput = document.getElementById('search');
            const dropdown = document.getElementById('suggestions-dropdown');
            
            if (!searchInput || !dropdown) return;
            
            let searchTimeout;
            
            searchInput.addEventListener('input', async function() {
                const query = this.value.trim();
                dropdown.innerHTML = '';
                
                if (query.length < 2) {
                    dropdown.style.display = 'none';
                    return;
                }
                
                clearTimeout(searchTimeout);
                
                searchTimeout = setTimeout(async () => {
                    try {
                        const results = await APIManager.searchCoins(query);
                        
                        if (results && results.length > 0) {
                            const limitedResults = results.slice(0, 6);
                            
                            limitedResults.forEach(coin => {
                                const item = document.createElement('div');
                                item.className = 'suggestion-item';
                                item.innerHTML = `
                                    <strong>${coin.name}</strong> (${coin.symbol.toUpperCase()})<br>
                                    <small>Ø±ØªØ¨Ù‡: ${coin.market_cap_rank || 'Ù†Ø§Ù…Ø´Ø®Øµ'}</small>
                                `;
                                
                                item.addEventListener('click', () => {
                                    searchInput.value = `${coin.name} (${coin.symbol.toUpperCase()})`;
                                    dropdown.style.display = 'none';
                                    searchAndAnalyze(coin.id);
                                });
                                
                                dropdown.appendChild(item);
                            });
                            
                            dropdown.style.display = 'block';
                        } else {
                            dropdown.style.display = 'none';
                        }
                    } catch (error) {
                        console.warn('Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ:', error);
                        dropdown.style.display = 'none';
                    }
                }, 300);
            });
            
            document.addEventListener('click', (e) => {
                if (!searchInput.contains(e.target) && !dropdown.contains(e.target)) {
                    dropdown.style.display = 'none';
                }
            });
            
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const query = searchInput.value.trim();
                    if (query.length >= 2) {
                        const foundCoinIn10 = allCoinsData10.find(c => 
                            c.name.toLowerCase().includes(query.toLowerCase()) || 
                            c.symbol.toLowerCase().includes(query.toLowerCase())
                        );
                        
                        const foundCoinIn40 = allCoinsData40.find(c => 
                            c.name.toLowerCase().includes(query.toLowerCase()) || 
                            c.symbol.toLowerCase().includes(query.toLowerCase())
                        );
                        
                        if (foundCoinIn10) {
                            searchAndAnalyze(foundCoinIn10.id);
                        } else if (foundCoinIn40) {
                            searchAndAnalyze(foundCoinIn40.id);
                        } else {
                            APIManager.searchCoins(query).then(results => {
                                if (results && results.length > 0) {
                                    const coin = results[0];
                                    searchAndAnalyze(coin.id);
                                } else {
                                    StatusManager.show('Ø§Ø±Ø² Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± ÛŒØ§ÙØª Ù†Ø´Ø¯.', 'warning');
                                }
                            }).catch(error => {
                                StatusManager.show('Ø®Ø·Ø§ Ø¯Ø± Ø¬Ø³ØªØ¬Ùˆ', 'error');
                            });
                        }
                    }
                }
            });
        }

        // ==================== Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ ====================
        function backToMainPage() {
            if (currentCharts.length > 0) {
                currentCharts.forEach(chart => chart.destroy());
                currentCharts = [];
            }
            
            document.getElementById('single-coin-section').style.display = 'none';
            document.getElementById('coins-section-10').style.display = 'none';
            document.getElementById('coins-section-40').style.display = 'none';
            document.getElementById('advanced-analysis-section').style.display = 'none';
            document.getElementById('output').style.display = 'block';
            
            StatusManager.show('Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ', 'info');
        }

        // ==================== Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø³ØªÛŒ ====================
        async function refreshData() {
            StatusManager.show('Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±...', 'info');
            
            coinCache.clear();
            
            if (CONFIG.CURRENT_MODE === 'top10' && allCoinsData10.length > 0) {
                await analyzeTop10Coins();
            } else if (CONFIG.CURRENT_MODE === 'top40' && allCoinsData40.length > 0) {
                await analyzeTop40Coins();
            } else {
                StatusManager.show('Ù„Ø·ÙØ§ Ø§Ø¨ØªØ¯Ø§ ÛŒÚ© ØªØ­Ù„ÛŒÙ„ Ø§Ù†Ø¬Ø§Ù… Ø¯Ù‡ÛŒØ¯.', 'warning');
            }
        }

        // ==================== Ù…Ø¯ÛŒØ±ÛŒØª Ø­Ø§Ù„Øªâ€ŒÙ‡Ø§ ====================
        function setupModeSelector() {
            const modeButtons = document.querySelectorAll('.mode-btn');
            
            modeButtons.forEach(btn => {
                btn.addEventListener('click', () => {
                    const mode = btn.getAttribute('data-mode');
                    
                    modeButtons.forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    
                    CONFIG.CURRENT_MODE = mode;
                    
                    if (mode === 'top10') {
                        document.getElementById('start-analysis-10-btn').classList.add('active');
                        document.getElementById('start-analysis-40-btn').classList.remove('active');
                    } else if (mode === 'top40') {
                        document.getElementById('start-analysis-10-btn').classList.remove('active');
                        document.getElementById('start-analysis-40-btn').classList.add('active');
                    } else if (mode === 'search') {
                        document.getElementById('start-analysis-10-btn').classList.remove('active');
                        document.getElementById('start-analysis-40-btn').classList.remove('active');
                    }
                    
                    backToMainPage();
                });
            });
        }

        // ==================== Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ ====================
        function showSearchHelp() {
            document.getElementById('output').innerHTML = `
                <div class="card">
                    <h2><i class="fas fa-question-circle"></i> Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ø¬Ø³ØªØ¬Ùˆ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø²</h2>
                    
                    <div class="analysis-box">
                        <h3>ğŸ“Š Ø±ÙˆØ´â€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„</h3>
                        <ul>
                            <li><strong>ØªØ­Ù„ÛŒÙ„ 10 Ø§Ø±Ø² Ø¨Ø±ØªØ±:</strong> Ø³Ø±ÛŒØ¹â€ŒØªØ±ÛŒÙ† Ø±ÙˆØ´ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±. Ù…Ù†Ø§Ø³Ø¨ Ø¨Ø±Ø§ÛŒ Ù†ÙˆØ³Ø§Ù†â€ŒÚ¯ÛŒØ±ÛŒ Ø±ÙˆØ²Ø§Ù†Ù‡.</li>
                            <li><strong>ØªØ­Ù„ÛŒÙ„ 40 Ø§Ø±Ø² Ø¨Ø±ØªØ±:</strong> ØªØ­Ù„ÛŒÙ„ Ø¬Ø§Ù…Ø¹â€ŒØªØ± Ø¨Ø§Ø²Ø§Ø±. ÙØ±ØµØªâ€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±ÛŒ Ø±Ø§ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.</li>
                            <li><strong>Ø¬Ø³ØªØ¬ÙˆÛŒ ØªÚ©ÛŒ:</strong> Ù‡Ø± Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø±Ø§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¬Ø³ØªØ¬Ùˆ Ùˆ ØªØ­Ù„ÛŒÙ„ Ú©Ù†ÛŒØ¯.</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h3>ğŸ” Ø±ÙˆØ´ Ø¬Ø³ØªØ¬Ùˆ</h3>
                        <ul>
                            <li>Ù†Ø§Ù… Ø§Ø±Ø² (Ù…Ø«Ø§Ù„: Bitcoin, Ethereum, Binance Coin)</li>
                            <li>Ù†Ù…Ø§Ø¯ Ø§Ø±Ø² (Ù…Ø«Ø§Ù„: BTC, ETH, BNB)</li>
                            <li>Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ø¨Ù‡ ÙØ§Ø±Ø³ÛŒ Ù‡Ù… Ø¬Ø³ØªØ¬Ùˆ Ú©Ù†ÛŒØ¯ (Ù…Ø«Ø§Ù„: Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†ØŒ Ø§ØªØ±ÛŒÙˆÙ…)</li>
                            <li>Ù¾Ø³ Ø§Ø² Ø¬Ø³ØªØ¬ÙˆØŒ Ø±ÙˆÛŒ Ù†ØªÛŒØ¬Ù‡ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h3>ğŸ¯ Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§</h3>
                        <ul>
                            <li><span class="badge buy">Ø®Ø±ÛŒØ¯</span>: Ø´Ø±Ø§ÛŒØ· Ø¨Ø±Ø§ÛŒ Ø®Ø±ÛŒØ¯ Ù…Ù†Ø§Ø³Ø¨ Ø§Ø³Øª</li>
                            <li><span class="badge sell">ÙØ±ÙˆØ´</span>: Ø¨Ù‡ØªØ± Ø§Ø³Øª Ø§Ø² Ø§Ø±Ø² Ø®Ø§Ø±Ø¬ Ø´ÙˆÛŒØ¯</li>
                            <li><span class="badge hold">Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ</span>: Ø§Ø±Ø² Ø±Ø§ Ù†Ú¯Ù‡ Ø¯Ø§Ø±ÛŒØ¯</li>
                            <li><span class="badge wait">ØµØ¨Ø±</span>: ØµØ¨Ø± Ú©Ù†ÛŒØ¯ ØªØ§ Ø´Ø±Ø§ÛŒØ· ÙˆØ§Ø¶Ø­â€ŒØªØ± Ø´ÙˆØ¯</li>
                        </ul>
                    </div>
                    
                    <div class="analysis-box">
                        <h3>ğŸš€ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯</h3>
                        <ul>
                            <li><strong>Ø³Ø·ÙˆØ­ ÙÛŒØ¨ÙˆÙ†Ø§Ú†ÛŒ:</strong> Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ù†Ù‚Ø§Ø· Ø¨Ø§Ø²Ú¯Ø´Øª Ù‚ÛŒÙ…Øª</li>
                            <li><strong>Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ:</strong> ØªØ´Ø®ÛŒØµ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ú©Ù„Ø§Ø³ÛŒÚ© Ø¨Ø§Ø²Ø§Ø±</li>
                            <li><strong>ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù…:</strong> Ø¨Ø±Ø±Ø³ÛŒ Ù‚Ø¯Ø±Øª Ø­Ø±Ú©Ø§Øª Ù‚ÛŒÙ…ØªÛŒ</li>
                            <li><strong>Ø­Ù…Ø§ÛŒØª/Ù…Ù‚Ø§ÙˆÙ…Øª:</strong> Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø³Ø·ÙˆØ­ Ú©Ù„ÛŒØ¯ÛŒ</li>
                            <li><strong>Ø§Ø®Ø¨Ø§Ø± Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ:</strong> Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø± Ø¨Ø§Ø²Ø§Ø±</li>
                            <li><strong>Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§:</strong> ØªÙ‚ÙˆÛŒÙ… Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ù‡Ù…</li>
                            <li><strong>Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¬ÛŒØ±Ù‡â€ŒØ§ÛŒ:</strong> ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ on-chain</li>
                        </ul>
                    </div>
                    
                    <button class="action-btn" onclick="backToMainPage()" style="margin-top:20px; padding:15px 30px; font-size:16px; width:100%;">
                        <i class="fas fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
                    </button>
                </div>`;
        }

        // ==================== Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø¨Ø±Ù†Ø§Ù…Ù‡ ====================
        function initializeApp() {
            document.getElementById('analyze-top10-btn').addEventListener('click', analyzeTop10Coins);
            document.getElementById('analyze-top40-btn').addEventListener('click', analyzeTop40Coins);
            document.getElementById('refresh-btn').addEventListener('click', refreshData);
            document.getElementById('start-analysis-10-btn').addEventListener('click', analyzeTop10Coins);
            document.getElementById('start-analysis-40-btn').addEventListener('click', analyzeTop40Coins);
            document.getElementById('show-search-help').addEventListener('click', showSearchHelp);
            
            setupSearch();
            setupModeSelector();
            Helpers.updateTimeDisplay();
            setInterval(Helpers.updateTimeDisplay, 60000);
            
            StatusManager.show('Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§Ø²Ø§Ø±. Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ÛŒÚ©ÛŒ Ø§Ø² Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.', 'info');
            
            console.log('ğŸš€ Ø¨Ø±Ù†Ø§Ù…Ù‡ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ - Ù†Ø³Ø®Ù‡ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø´Ø¯');
        }

        // ==================== Ø´Ø±ÙˆØ¹ Ø¨Ø±Ù†Ø§Ù…Ù‡ ====================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ“Š Ø¨Ø±Ù†Ø§Ù…Ù‡ ØªØ­Ù„ÛŒÙ„ Ø§Ø±Ø² Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¨Ø§Ø±Ú¯ÛŒØ±ÛŒ Ø´Ø¯');
            initializeApp();
        });
    </script>
</body>
</html>